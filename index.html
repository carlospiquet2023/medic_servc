<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedPro - Sistema MÃ©dico Completo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #10b981;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f3f4f6;
            --border: #e5e7eb;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .nav-tabs {
            display: flex;
            background: var(--light);
            border-bottom: 2px solid var(--border);
            overflow-x: auto;
        }

        .nav-tab {
            padding: 20px 30px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: var(--dark);
            transition: all 0.3s;
            position: relative;
            white-space: nowrap;
        }

        .nav-tab:hover {
            background: white;
        }

        .nav-tab.active {
            background: white;
            color: var(--primary);
            font-weight: 600;
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary);
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            color: var(--dark);
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
        }

        input, select, textarea {
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
        }

        .btn-success {
            background: var(--secondary);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .quick-templates {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .template-card {
            padding: 20px;
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .template-card:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .template-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .medicines-list, .exams-list {
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .medicine-item, .exam-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--light);
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .medicine-info, .exam-info {
            flex: 1;
        }

        .preview {
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 30px;
            background: white;
            margin-top: 30px;
            position: relative;
            min-height: 600px;
        }

        .preview-header {
            text-align: center;
            border-bottom: 2px solid var(--border);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .clinic-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
        }

        .doctor-info {
            margin-bottom: 10px;
        }

        .patient-info {
            background: var(--light);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .prescription-content {
            min-height: 300px;
            margin-bottom: 30px;
        }

        .signature-section {
            margin-top: 50px;
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid var(--dark);
            width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding-left: 40px;
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
        }

        .autocomplete-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid var(--border);
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .autocomplete-suggestions.active {
            display: block;
        }

        .suggestion-item {
            padding: 12px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .suggestion-item:hover {
            background: var(--light);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-modal {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            background: var(--light);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-modal:hover {
            background: var(--border);
        }

        @media print {
            body { background: white; padding: 0; }
            .container { box-shadow: none; }
            .header, .nav-tabs, .actions, .btn { display: none; }
            .preview { border: none; }
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-templates {
                grid-template-columns: 1fr;
            }
            
            .actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">âï¸</div>
                <div>
                    <h1>MedPro System</h1>
                    <p>Sistema MÃ©dico Completo</p>
                </div>
            </div>
            <div class="stats-grid" style="display: flex; gap: 20px;">
                <div style="text-align: center;">
                    <div style="font-size: 24px; font-weight: bold;">152</div>
                    <div style="font-size: 12px;">Receitas Hoje</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 24px; font-weight: bold;">89</div>
                    <div style="font-size: 12px;">Exames Hoje</div>
                </div>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('prescription')">ð ReceituÃ¡rio</button>
            <button class="nav-tab" onclick="switchTab('exams')">ð¬ SolicitaÃ§Ã£o de Exames</button>
            <button class="nav-tab" onclick="switchTab('certificate')">ð Atestado MÃ©dico</button>
            <button class="nav-tab" onclick="switchTab('history')">ð HistÃ³rico</button>
            <button class="nav-tab" onclick="switchTab('settings')">âï¸ ConfiguraÃ§Ãµes</button>
        </div>

        <div class="content">
            <!-- ReceituÃ¡rio Tab -->
            <div id="prescription" class="tab-content active">
                <h2 style="margin-bottom: 20px;">Nova Receita MÃ©dica</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="patientName">Nome do Paciente*</label>
                        <input type="text" id="patientName" placeholder="Digite o nome completo">
                    </div>
                    <div class="form-group">
                        <label for="patientCPF">CPF</label>
                        <input type="text" id="patientCPF" placeholder="000.000.000-00">
                    </div>
                    <div class="form-group">
                        <label for="patientBirth">Data de Nascimento</label>
                        <input type="date" id="patientBirth" onchange="updateAgeFromBirth()">
                    </div>
                    <div class="form-group">
                        <label for="patientAge">Idade</label>
                        <input type="number" id="patientAge" placeholder="Idade (anos)" min="0">
                    </div>
                    <div class="form-group">
                        <label for="patientSex">Sexo</label>
                        <select id="patientSex">
                            <option value="">--</option>
                            <option value="masculino">Masculino</option>
                            <option value="feminino">Feminino</option>
                            <option value="outro">Outro/NÃ£o informado</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="patientWeight">Peso (kg)</label>
                        <input type="number" id="patientWeight" placeholder="Peso em kg" step="0.1" min="0">
                    </div>
                    <div class="form-group">
                        <label for="patientPhone">Telefone</label>
                        <input type="tel" id="patientPhone" placeholder="(00) 00000-0000">
                    </div>
                </div>

                <h3 style="margin-bottom: 15px;">Templates RÃ¡pidos</h3>
                <div class="quick-templates">
                    <button type="button" class="template-card" onclick="loadTemplate('hipertensao')">
                        <div class="template-icon">â¤ï¸</div>
                        <div>HipertensÃ£o</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('diabetes')">
                        <div class="template-icon">ð</div>
                        <div>Diabetes</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('gripe')">
                        <div class="template-icon">ð¤§</div>
                        <div>Gripe/Resfriado</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('dor')">
                        <div class="template-icon">ð</div>
                        <div>AnalgÃ©sicos</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('antibiotico')">
                        <div class="template-icon">ð¦ </div>
                        <div>AntibiÃ³ticos</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('ansiedade')">
                        <div class="template-icon">ð§ </div>
                        <div>Ansiedade</div>
                    </button>
                </div>

                <h3 style="margin-bottom: 15px;">Adicionar Medicamento</h3>
                <div class="search-box">
                    <span class="search-icon">ð</span>
                    <input type="text" id="medicineSearch" placeholder="Digite o nome do medicamento..." onkeyup="searchMedicine(this.value)">
                    <div class="autocomplete-suggestions" id="medicineSuggestions"></div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                            <label for="medicineName">Medicamento</label>
                            <div style="display:flex; gap:8px; align-items:center;">
                                <input type="text" id="medicineName" placeholder="Nome do medicamento">
                                <button type="button" class="btn btn-primary" onclick="openMedicineModal()" style="padding:8px 12px; font-size:14px;">ð Lista</button>
                            </div>
                        </div>
                    <div class="form-group">
                        <label for="medicineDosage">Dosagem</label>
                        <input type="text" id="medicineDosage" placeholder="Ex: 500 mg">
                    </div>
                    <div class="form-group">
                        <label for="medicineQuantity">Quantidade</label>
                        <input type="text" id="medicineQuantity" placeholder="Ex: 1 caixa">
                    </div>
                    <div class="form-group">
                        <label for="medicinePosology">Posologia</label>
                        <input type="text" id="medicinePosology" placeholder="Ex: 1 comprimido de 8/8h">
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="addMedicine()">+ Adicionar Medicamento</button>

                <h3 style="margin: 20px 0 15px;">Medicamentos Adicionados</h3>
                <div class="medicines-list" id="medicinesList">
                    <p style="color: #9ca3af; text-align: center;">Nenhum medicamento adicionado</p>
                </div>

                <div class="form-group">
                    <label for="prescriptionObs">ObservaÃ§Ãµes</label>
                    <textarea id="prescriptionObs" placeholder="ObservaÃ§Ãµes adicionais..."></textarea>
                </div>

                <div class="actions">
                    <button class="btn btn-primary" onclick="generatePrescription()">ð Gerar Receita</button>
                    <button class="btn btn-success" onclick="printDocument()">ð¨ï¸ Imprimir</button>
                    <button class="btn btn-danger" onclick="clearPrescription()">ðï¸ Limpar</button>
                </div>
            </div>

            <!-- Exames Tab -->
            <div id="exams" class="tab-content">
                <h2 style="margin-bottom: 20px;">SolicitaÃ§Ã£o de Exames</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="examPatientName">Nome do Paciente*</label>
                        <input type="text" id="examPatientName" placeholder="Digite o nome completo">
                    </div>
                    <div class="form-group">
                        <label for="examPatientCPF">CPF</label>
                        <input type="text" id="examPatientCPF" placeholder="000.000.000-00">
                    </div>
                    <div class="form-group">
                        <label for="examInsurance">ConvÃªnio</label>
                        <select id="examInsurance">
                            <option value="">Particular</option>
                            <option value="SUS">SUS</option>
                            <option value="Unimed">Unimed</option>
                            <option value="Bradesco">Bradesco SaÃºde</option>
                            <option value="Amil">Amil</option>
                            <option value="SulAmerica">SulAmÃ©rica</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="examInsuranceNumber">MatrÃ­cula/Carteirinha</label>
                        <input type="text" id="examInsuranceNumber" placeholder="NÃºmero do convÃªnio">
                    </div>
                </div>

                <h3 style="margin-bottom: 15px;">Exames RÃ¡pidos</h3>
                <div class="quick-templates">
                    <button type="button" class="template-card" onclick="loadExamTemplate('rotina')">
                        <div class="template-icon">ð©¸</div>
                        <div>Exames de Rotina</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadExamTemplate('cardiaco')">
                        <div class="template-icon">â¤ï¸</div>
                        <div>Check-up CardÃ­aco</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadExamTemplate('prenatal')">
                        <div class="template-icon">ð¤°</div>
                        <div>PrÃ©-natal</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadExamTemplate('hormonal')">
                        <div class="template-icon">âï¸</div>
                        <div>Perfil Hormonal</div>
                    </button>
                </div>

                <h3 style="margin-bottom: 15px;">Adicionar Exame</h3>
                <div class="search-box">
                    <span class="search-icon">ð</span>
                    <input type="text" id="examSearch" placeholder="Digite o nome do exame..." onkeyup="searchExam(this.value)">
                    <div class="autocomplete-suggestions" id="examSuggestions"></div>
                </div>

                <div class="form-grid">
                    <div class="form-group" style="grid-column: span 2;">
                            <label for="examName">Exame</label>
                            <div style="display:flex; gap:8px; align-items:center;">
                                <input type="text" id="examName" placeholder="Nome do exame">
                                <button type="button" class="btn btn-primary" onclick="openExamModal()" style="padding:8px 12px; font-size:14px;">ð Lista</button>
                            </div>
                        </div>
                    <div class="form-group">
                        <label for="examUrgency">UrgÃªncia</label>
                        <select id="examUrgency">
                            <option value="normal">Normal</option>
                            <option value="urgente">Urgente</option>
                            <option value="emergencia">EmergÃªncia</option>
                        </select>
                    </div>
                </div>

                <button class="btn btn-success" onclick="addExam()">+ Adicionar Exame</button>

                <h3 style="margin: 20px 0 15px;">Exames Solicitados</h3>
                <div class="exams-list" id="examsList">
                    <p style="color: #9ca3af; text-align: center;">Nenhum exame adicionado</p>
                </div>

                <div class="form-group">
                    <label for="examDiagnosis">HipÃ³tese DiagnÃ³stica</label>
                    <textarea id="examDiagnosis" placeholder="CID ou descriÃ§Ã£o..."></textarea>
                </div>

                <div class="form-group">
                    <label for="examObs">ObservaÃ§Ãµes ClÃ­nicas</label>
                    <textarea id="examObs" placeholder="InformaÃ§Ãµes clÃ­nicas relevantes..."></textarea>
                </div>

                <div class="actions">
                    <button class="btn btn-primary" onclick="generateExamRequest()">ð Gerar SolicitaÃ§Ã£o</button>
                    <button class="btn btn-success" onclick="printDocument()">ð¨ï¸ Imprimir</button>
                    <button class="btn btn-danger" onclick="clearExams()">ðï¸ Limpar</button>
                </div>
            </div>

            <!-- Atestado Tab -->
            <div id="certificate" class="tab-content">
                <h2 style="margin-bottom: 20px;">Atestado MÃ©dico</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="certPatientName">Nome do Paciente*</label>
                        <input type="text" id="certPatientName" placeholder="Digite o nome completo">
                    </div>
                    <div class="form-group">
                        <label for="certPatientDoc">RG/CPF</label>
                        <input type="text" id="certPatientDoc" placeholder="Documento">
                    </div>
                    <div class="form-group">
                        <label for="certDays">Dias de Afastamento</label>
                        <input type="number" id="certDays" placeholder="NÃºmero de dias" min="1">
                    </div>
                    <div class="form-group">
                        <label for="certStartDate">A partir de</label>
                        <input type="date" id="certStartDate">
                    </div>
                </div>

                <div class="form-group">
                    <label for="certCID">CID (opcional)</label>
                    <input type="text" id="certCID" placeholder="CÃ³digo CID-10">
                </div>

                <div class="form-group">
                    <label for="certReason">Motivo do Atestado</label>
                    <textarea id="certReason" placeholder="Descreva o motivo do afastamento..."></textarea>
                </div>

                <div class="actions">
                    <button class="btn btn-primary" onclick="generateCertificate()">ð Gerar Atestado</button>
                    <button class="btn btn-success" onclick="printDocument()">ð¨ï¸ Imprimir</button>
                    <button class="btn btn-danger" onclick="clearCertificate()">ðï¸ Limpar</button>
                </div>
            </div>

            <!-- HistÃ³rico Tab -->
            <div id="history" class="tab-content">
                <h2 style="margin-bottom: 20px;">HistÃ³rico de Documentos</h2>
                
                <div class="search-box">
                    <span class="search-icon">ð</span>
                    <input type="text" placeholder="Buscar por paciente, data ou tipo...">
                </div>

                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: var(--light);">
                                <th style="padding: 15px; text-align: left;">Data</th>
                                <th style="padding: 15px; text-align: left;">Paciente</th>
                                <th style="padding: 15px; text-align: left;">Tipo</th>
                                <th style="padding: 15px; text-align: left;">AÃ§Ãµes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 15px;">22/09/2025</td>
                                <td style="padding: 15px;">Maria Silva</td>
                                <td style="padding: 15px;">Receita</td>
                                <td style="padding: 15px;">
                                    <button class="btn btn-primary" style="padding: 8px 16px; font-size: 14px;">Visualizar</button>
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 15px;">22/09/2025</td>
                                <td style="padding: 15px;">JoÃ£o Santos</td>
                                <td style="padding: 15px;">Exames</td>
                                <td style="padding: 15px;">
                                    <button class="btn btn-primary" style="padding: 8px 16px; font-size: 14px;">Visualizar</button>
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border);">
                                <td style="padding: 15px;">21/09/2025</td>
                                <td style="padding: 15px;">Ana Costa</td>
                                <td style="padding: 15px;">Atestado</td>
                                <td style="padding: 15px;">
                                    <button class="btn btn-primary" style="padding: 8px 16px; font-size: 14px;">Visualizar</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ConfiguraÃ§Ãµes Tab -->
            <div id="settings" class="tab-content">
                <h2 style="margin-bottom: 20px;">ConfiguraÃ§Ãµes do Sistema</h2>
                
                <h3 style="margin-bottom: 15px;">Dados do MÃ©dico</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="doctorName">Nome Completo</label>
                        <input type="text" id="doctorName" value="Dr. JosÃ© Silva" placeholder="Nome do mÃ©dico">
                    </div>
                    <div class="form-group">
                        <label for="doctorCRM">CRM</label>
                        <input type="text" id="doctorCRM" value="CRM/RJ 123456" placeholder="CRM/UF 000000">
                    </div>
                    <div class="form-group">
                        <label for="doctorSpecialty">Especialidade</label>
                        <input type="text" id="doctorSpecialty" value="ClÃ­nica Geral" placeholder="Especialidade">
                    </div>
                    <div class="form-group">
                        <label for="doctorPhone">Telefone</label>
                        <input type="tel" id="doctorPhone" value="(21) 98765-4321" placeholder="Telefone">
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px;">Dados da ClÃ­nica</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="clinicName">Nome da ClÃ­nica</label>
                        <input type="text" id="clinicName" value="ClÃ­nica SaÃºde Total" placeholder="Nome da clÃ­nica">
                    </div>
                    <div class="form-group">
                        <label for="clinicCNPJ">CNPJ</label>
                        <input type="text" id="clinicCNPJ" placeholder="00.000.000/0000-00">
                    </div>
                </div>
                <h3 style="margin: 30px 0 15px;">Gerenciar Lista de Medicamentos</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="externalMedUrl">Carregar lista externa (fetch)</label>
                        <input type="text" id="externalMedUrl" placeholder="medicacoes/medicamentos.json" value="medicacoes/medicamentos.json">
                        <small style="color:#6b7280; margin-top:6px; display:block;">Tente carregar este arquivo (funciona se servido por HTTP/S). Se estiver abrindo via file:// use o upload abaixo.</small>
                        <div style="margin-top:8px; display:flex; gap:8px;">
                            <button class="btn btn-primary" onclick="loadExternalMedications()">ð Carregar via URL</button>
                            <button class="btn" onclick="resetToBuiltin()">â² Usar interno</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="uploadMeds">Importar arquivo (JSON ou CSV)</label>
                        <input type="file" id="uploadMeds" accept=".json,.csv" onchange="handleMedFileUpload(this.files)">
                        <small style="color:#6b7280; margin-top:6px; display:block;">Selecione um JSON com formato de array de objetos ou CSV (name,id,unitMg,...).</small>
                    </div>
                    <div class="form-group">
                        <label for="generateCount">Gerar CatÃ¡logo Grande</label>
                        <div style="display:flex; gap:8px; align-items:center;">
                            <input type="number" id="generateCount" value="3000" min="100" max="10000" style="width:120px; padding:8px;"> 
                            <button class="btn btn-primary" onclick="generateAndDownloadCatalog()">â¬ï¸ Gerar e Baixar CatÃ¡logo</button>
                        </div>
                        <small style="color:#6b7280; display:block; margin-top:6px;">Gera um JSON com contagem especificada contendo entradas padronizadas (vocÃª pode editar depois).</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // NavegaÃ§Ã£o entre abas
        function switchTab(tabName) {
            // Esconder todas as abas
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remover classe active dos botÃµes
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            
            // Mostrar aba selecionada
            document.getElementById(tabName).classList.add('active');
            
            // Adicionar classe active ao botÃ£o clicado
            event.target.classList.add('active');
        }

        // Handler para upload local de arquivo de medicamentos (JSON/CSV)
        function handleMedFileUpload(files) {
            if (!files || files.length === 0) return;
            const f = files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                // tentar JSON primeiro
                try {
                    const parsed = JSON.parse(text);
                    applyMedicationsToMemory(parsed);
                    alert('Lista de medicamentos importada com sucesso (JSON).');
                    return;
                } catch (jsonErr) {
                    // tentar CSV simples (colunas: nome_medicacao,dosagem,unidade ou name,dosage,unit)
                    try {
                        const lines = text.split(/\r?\n/).map(l => l.trim()).filter(Boolean);
                        const header = lines.shift().split(/,|;|\t/).map(h => h.trim().toLowerCase());
                        const arr = lines.map(line => {
                            const cols = line.split(/,|;|\t/).map(c => c.trim());
                            const obj = {};
                            header.forEach((h,i) => obj[h] = cols[i] || '');
                            return obj;
                        });
                        applyMedicationsToMemory(arr);
                        alert('Lista de medicamentos importada com sucesso (CSV).');
                        return;
                    } catch (csvErr) {
                        console.debug('Falha ao parsear arquivo de medicaÃ§Ãµes:', jsonErr.message || jsonErr, csvErr.message || csvErr);
                        alert('NÃ£o foi possÃ­vel importar o arquivo. Verifique o formato (JSON/CSV).');
                    }
                }
            };
            reader.onerror = function(e) {
                alert('Erro ao ler o arquivo: ' + (e.message || e));
            };
            reader.readAsText(f, 'UTF-8');
        }

        // Templates de medicamentos
        const medicineTemplates = {
            hipertensao: [
                { name: 'Losartana PotÃ¡ssica', dosage: '50mg', quantity: '30 comprimidos', posology: '1 comprimido ao dia' },
                { name: 'Amlodipina', dosage: '5mg', quantity: '30 comprimidos', posology: '1 comprimido ao dia' }
            ],
            diabetes: [
                { name: 'Metformina', dosage: '500mg', quantity: '60 comprimidos', posology: '1 comprimido de 12/12h' },
                { name: 'Gliclazida', dosage: '30mg', quantity: '30 comprimidos', posology: '1 comprimido ao dia' }
            ],
            gripe: [
                { name: 'Paracetamol', dosage: '500mg', quantity: '20 comprimidos', posology: '1 comprimido de 6/6h se dor/febre' },
                { name: 'Dipirona', dosage: '500mg', quantity: '10 comprimidos', posology: '1 comprimido de 6/6h se dor' }
            ],
            dor: [
                { name: 'Ibuprofeno', dosage: '400mg', quantity: '20 comprimidos', posology: '1 comprimido de 8/8h se dor' },
                { name: 'Paracetamol', dosage: '750mg', quantity: '20 comprimidos', posology: '1 comprimido de 6/6h se dor' }
            ],
            antibiotico: [
                { name: 'Amoxicilina', dosage: '500mg', quantity: '21 cÃ¡psulas', posology: '1 cÃ¡psula de 8/8h por 7 dias' }
            ],
            ansiedade: [
                { name: 'Sertralina', dosage: '50mg', quantity: '30 comprimidos', posology: '1 comprimido ao dia' },
                { name: 'Clonazepam', dosage: '0.5mg', quantity: '30 comprimidos', posology: '1 comprimido ao dia' }
            ]
        };

        // Templates de exames
        const examTemplates = {
            rotina: [
                'Hemograma Completo',
                'Glicemia de Jejum',
                'Colesterol Total e FraÃ§Ãµes',
                'TriglicerÃ­deos',
                'Creatinina',
                'TSH',
                'Urina Tipo I',
                'ParasitolÃ³gico de Fezes'
            ],
            cardiaco: [
                'Eletrocardiograma',
                'Ecocardiograma',
                'Colesterol Total e FraÃ§Ãµes',
                'TriglicerÃ­deos',
                'Glicemia de Jejum',
                'Hemoglobina Glicada'
            ],
            prenatal: [
                'Hemograma',
                'Glicemia de Jejum',
                'Toxoplasmose IgM e IgG',
                'Rubeola IgM e IgG',
                'Citomegalovirus IgM e IgG',
                'SÃ­filis (VDRL)',
                'HIV',
                'Ultrassonografia ObstÃ©trica'
            ],
            hormonal: [
                'TSH',
                'T4 Livre',
                'Cortisol',
                'Testosterona Total',
                'Prolactina',
                'FSH',
                'LH'
            ]
        };

        // Carregar template de medicamento
        function loadTemplate(templateName) {
            const template = medicineTemplates[templateName];
            if (template) {
                template.forEach(medicine => {
                    document.getElementById('medicineName').value = medicine.name;
                    // Campo dosagem removido, definir quantity e posology
                    document.getElementById('medicineQuantity').value = medicine.quantity;
                    document.getElementById('medicinePosology').value = medicine.posology;
                    addMedicine();
                });
            }
        }

        // Carregar template de exame
        function loadExamTemplate(templateName) {
            const template = examTemplates[templateName];
            if (template) {
                template.forEach(exam => {
                    document.getElementById('examName').value = exam;
                    addExam();
                });
            }
        }

        // A funÃ§Ã£o addMedicine Ã© implementada abaixo (versÃ£o Ãºnica com preenchimento automÃ¡tico)

        // Adicionar exame
        function addExam() {
            const name = document.getElementById('examName').value.trim();
            const urgency = document.getElementById('examUrgency').value;

            if (!name) {
                alert('Por favor, digite o nome do exame.');
                return;
            }

            const examsList = document.getElementById('examsList');
            
            // Remover mensagem de lista vazia
            if (examsList.querySelector('p')) {
                examsList.innerHTML = '';
            }

            let urgencyText = 'ð¢ Normal';
            if (urgency === 'urgente') {
                urgencyText = 'ð´ Urgente';
            } else if (urgency === 'emergencia') {
                urgencyText = 'ð´ð´ EmergÃªncia';
            }

            const examItem = document.createElement('div');
            examItem.className = 'exam-item';
            examItem.innerHTML = `
                <div class="exam-info">
                    <strong>${name}</strong><br>
                    <small>${urgencyText}</small>
                </div>
                <button class="btn btn-danger" onclick="removeItem(this)" style="padding: 8px 16px; font-size: 14px;">Remover</button>
            `;

            examsList.appendChild(examItem);

            // Limpar campos
            document.getElementById('examName').value = '';
            document.getElementById('examUrgency').value = 'normal';
        }

        // Remover item
        function removeItem(button) {
            button.closest('.medicine-item, .exam-item').remove();
            
            // Verificar se lista ficou vazia
            const list = button.closest('.medicines-list, .exams-list');
            if (list.children.length === 0) {
                list.innerHTML = '<p style="color: #9ca3af; text-align: center;">Nenhum item adicionado</p>';
            }
        }

        // Gerar receita
        function generatePrescription() {
            const patientName = document.getElementById('patientName').value.trim();
            if (!patientName) {
                alert('Por favor, digite o nome do paciente.');
                return;
            }

            const medicines = document.querySelectorAll('#medicinesList .medicine-item');
            if (medicines.length === 0) {
                alert('Por favor, adicione pelo menos um medicamento.');
                return;
            }

            const preview = document.querySelector('.preview');
            const doctorName = document.getElementById('doctorName').value || 'Dr. JosÃ© Silva';
            const doctorCRM = document.getElementById('doctorCRM').value || 'CRM/RJ 123456';
            const clinicName = document.getElementById('clinicName').value || 'ClÃ­nica SaÃºde Total';

            let medicinesHTML = '';
            medicines.forEach(medicine => {
                medicinesHTML += `<div style="margin-bottom: 15px; padding: 10px; background: var(--light); border-radius: 8px;">
                    ${medicine.querySelector('.medicine-info').innerHTML}
                </div>`;
            });

            const obs = document.getElementById('prescriptionObs').value;

            preview.innerHTML = `
                <div class="preview-header">
                    <div class="clinic-logo">ð¥</div>
                    <h2>${clinicName}</h2>
                    <p>ReceituÃ¡rio MÃ©dico</p>
                </div>

                <div class="patient-info">
                    <h3>Dados do Paciente</h3>
                    <p><strong>Nome:</strong> ${patientName}</p>
                    <p><strong>Data:</strong> ${new Date().toLocaleDateString('pt-BR')}</p>
                </div>

                <div class="prescription-content">
                    <h3>Medicamentos Prescritos</h3>
                    ${medicinesHTML}
                    ${obs ? `<div style="margin-top: 20px;"><strong>ObservaÃ§Ãµes:</strong><br>${obs}</div>` : ''}
                </div>

                <div class="doctor-info">
                    <p><strong>MÃ©dico:</strong> ${doctorName}</p>
                    <p><strong>CRM:</strong> ${doctorCRM}</p>
                </div>

                <div class="signature-section">
                    <p>_______________________________</p>
                    <p>Assinatura do MÃ©dico</p>
                </div>
            `;

            preview.style.display = 'block';
        }

        // Gerar solicitaÃ§Ã£o de exames
        function generateExamRequest() {
            const patientName = document.getElementById('examPatientName').value.trim();
            if (!patientName) {
                alert('Por favor, digite o nome do paciente.');
                return;
            }

            const exams = document.querySelectorAll('#examsList .exam-item');
            if (exams.length === 0) {
                alert('Por favor, adicione pelo menos um exame.');
                return;
            }

            const preview = document.querySelector('.preview');
            const doctorName = document.getElementById('doctorName').value || 'Dr. JosÃ© Silva';
            const doctorCRM = document.getElementById('doctorCRM').value || 'CRM/RJ 123456';
            const clinicName = document.getElementById('clinicName').value || 'ClÃ­nica SaÃºde Total';

            let examsHTML = '';
            exams.forEach(exam => {
                examsHTML += `<div style="margin-bottom: 10px; padding: 10px; background: var(--light); border-radius: 8px;">
                    ${exam.querySelector('.exam-info').innerHTML}
                </div>`;
            });

            const diagnosis = document.getElementById('examDiagnosis').value;
            const obs = document.getElementById('examObs').value;

            preview.innerHTML = `
                <div class="preview-header">
                    <div class="clinic-logo">ð¥</div>
                    <h2>${clinicName}</h2>
                    <p>SolicitaÃ§Ã£o de Exames Laboratoriais</p>
                </div>

                <div class="patient-info">
                    <h3>Dados do Paciente</h3>
                    <p><strong>Nome:</strong> ${patientName}</p>
                    <p><strong>Data:</strong> ${new Date().toLocaleDateString('pt-BR')}</p>
                </div>

                <div class="prescription-content">
                    <h3>Exames Solicitados</h3>
                    ${examsHTML}
                    ${diagnosis ? `<div style="margin-top: 20px;"><strong>HipÃ³tese DiagnÃ³stica:</strong><br>${diagnosis}</div>` : ''}
                    ${obs ? `<div style="margin-top: 20px;"><strong>ObservaÃ§Ãµes ClÃ­nicas:</strong><br>${obs}</div>` : ''}
                </div>

                <div class="doctor-info">
                    <p><strong>MÃ©dico Solicitante:</strong> ${doctorName}</p>
                    <p><strong>CRM:</strong> ${doctorCRM}</p>
                </div>

                <div class="signature-section">
                    <p>_______________________________</p>
                    <p>Assinatura do MÃ©dico</p>
                </div>
            `;

            preview.style.display = 'block';
        }

        // Gerar atestado
        function generateCertificate() {
            const patientName = document.getElementById('certPatientName').value.trim();
            const days = document.getElementById('certDays').value;
            const startDate = document.getElementById('certStartDate').value;

            if (!patientName || !days || !startDate) {
                alert('Por favor, preencha todos os campos obrigatÃ³rios.');
                return;
            }

            const preview = document.querySelector('.preview');
            const doctorName = document.getElementById('doctorName').value || 'Dr. JosÃ© Silva';
            const doctorCRM = document.getElementById('doctorCRM').value || 'CRM/RJ 123456';
            const clinicName = document.getElementById('clinicName').value || 'ClÃ­nica SaÃºde Total';

            const endDate = new Date(startDate);
            endDate.setDate(endDate.getDate() + parseInt(days) - 1);
            const reason = document.getElementById('certReason').value;
            const cid = document.getElementById('certCID').value;

            preview.innerHTML = `
                <div class="preview-header">
                    <div class="clinic-logo">ð¥</div>
                    <h2>${clinicName}</h2>
                    <p>Atestado MÃ©dico</p>
                </div>

                <div class="prescription-content">
                    <p style="text-align: center; margin: 30px 0;">
                        <strong>ATESTADO MÃDICO</strong>
                    </p>

                    <p>Atesto, para os devidos fins, que o(a) paciente <strong>${patientName}</strong> foi atendido(a) nesta clÃ­nica no dia ${new Date().toLocaleDateString('pt-BR')}, necessitando de afastamento de suas atividades laborais por <strong>${days} dias</strong>, no perÃ­odo de <strong>${new Date(startDate).toLocaleDateString('pt-BR')}</strong> a <strong>${endDate.toLocaleDateString('pt-BR')}</strong>.</p>

                    ${reason ? `<p><strong>Motivo:</strong> ${reason}</p>` : ''}
                    ${cid ? `<p><strong>CID:</strong> ${cid}</p>` : ''}

                    <p style="margin-top: 50px;">Rio de Janeiro, ${new Date().toLocaleDateString('pt-BR')}</p>
                </div>

                <div class="doctor-info">
                    <p><strong>MÃ©dico:</strong> ${doctorName}</p>
                    <p><strong>CRM:</strong> ${doctorCRM}</p>
                </div>

                <div class="signature-section">
                    <p>_______________________________</p>
                    <p>Assinatura do MÃ©dico</p>
                </div>
            `;

            preview.style.display = 'block';
        }

        // Imprimir documento
        function printDocument() {
            window.print();
        }

        // Limpar receita
        function clearPrescription() {
            document.getElementById('patientName').value = '';
            document.getElementById('patientCPF').value = '';
            document.getElementById('patientBirth').value = '';
            document.getElementById('patientPhone').value = '';
            document.getElementById('medicinesList').innerHTML = '<p style="color: #9ca3af; text-align: center;">Nenhum medicamento adicionado</p>';
            document.getElementById('prescriptionObs').value = '';
            document.querySelector('.preview').style.display = 'none';
        }

        // Limpar exames
        function clearExams() {
            document.getElementById('examPatientName').value = '';
            document.getElementById('examPatientCPF').value = '';
            document.getElementById('examInsurance').value = '';
            document.getElementById('examInsuranceNumber').value = '';
            document.getElementById('examsList').innerHTML = '<p style="color: #9ca3af; text-align: center;">Nenhum exame adicionado</p>';
            document.getElementById('examDiagnosis').value = '';
            document.getElementById('examObs').value = '';
            document.querySelector('.preview').style.display = 'none';
        }

        // Limpar atestado
        function clearCertificate() {
            document.getElementById('certPatientName').value = '';
            document.getElementById('certPatientDoc').value = '';
            document.getElementById('certDays').value = '';
            document.getElementById('certStartDate').value = '';
            document.getElementById('certCID').value = '';
            document.getElementById('certReason').value = '';
            document.querySelector('.preview').style.display = 'none';
        }

        // Busca de medicamentos (simulada)
        // Banco de medicamentos com regras de dosagem (simplificado e ilustrativo)
        const medicines = [
            // Os campos unitMg e defaultDurationDays sÃ£o auxiliares para cÃ¡lculo automÃ¡tico.
            { id: 'paracetamol', name: 'Paracetamol', type: 'analgÃ©sico', adultDoseMgKg: 15, maxPerDoseMg: 1000, maxPerDayMg: 4000, unitMg: 500, defaultDurationDays: 3 },
            { id: 'ibuprofeno', name: 'Ibuprofeno', type: 'anti-inflamatÃ³rio', adultDoseMgKg: 10, maxPerDoseMg: 400, maxPerDayMg: 1200, unitMg: 400, defaultDurationDays: 3 },
            { id: 'dipirona', name: 'Dipirona', type: 'analgÃ©sico', adultDoseMgKg: 10, maxPerDoseMg: 1000, maxPerDayMg: 4000, unitMg: 500, defaultDurationDays: 3 },
            { id: 'amoxicilina', name: 'Amoxicilina', type: 'antibiÃ³tico', adultDoseMgKg: 25, maxPerDoseMg: 1000, maxPerDayMg: 3000, unitMg: 500, defaultDurationDays: 7 },
            { id: 'azitromicina', name: 'Azitromicina', type: 'antibiÃ³tico', adultDoseMgKg: 10, maxPerDoseMg: 500, maxPerDayMg: 1500, unitMg: 500, defaultDurationDays: 3 },
            { id: 'losartana', name: 'Losartana PotÃ¡ssica', type: 'antihipertensivo', standardDoseMg: 50, unitMg: 50, defaultDurationDays: 30 },
            { id: 'amlodipina', name: 'Amlodipina', type: 'antihipertensivo', standardDoseMg: 5, unitMg: 5, defaultDurationDays: 30 },
            { id: 'metformina', name: 'Metformina', type: 'antidiabÃ©tico', standardDoseMg: 500, unitMg: 500, defaultDurationDays: 30 },
            { id: 'gliclazida', name: 'Gliclazida', type: 'antidiabÃ©tico', standardDoseMg: 30, unitMg: 30, defaultDurationDays: 30 },
            { id: 'sertralina', name: 'Sertralina', type: 'psicotrÃ³pico', standardDoseMg: 50, unitMg: 50, defaultDurationDays: 30 },
            { id: 'omeprazol', name: 'Omeprazol', type: 'inibidor de bomba', standardDoseMg: 20, unitMg: 20, defaultDurationDays: 14 },
            { id: 'pantoprazol', name: 'Pantoprazol', type: 'inibidor de bomba', standardDoseMg: 40, unitMg: 40, defaultDurationDays: 14 }
        ];

        function searchMedicine(query) {
            const suggestions = document.getElementById('medicineSuggestions');
            if (query.length < 2) {
                suggestions.classList.remove('active');
                return;
            }

            const filtered = medicines.filter(med => med.name.toLowerCase().includes(query.toLowerCase()));

            if (filtered.length > 0) {
                suggestions.innerHTML = filtered.map(med => `<div class="suggestion-item" onclick="selectMedicine('${med.id}')">${med.name}</div>`).join('');
                suggestions.classList.add('active');
            } else {
                suggestions.classList.remove('active');
            }
        }

        function selectMedicine(id) {
            const med = medicines.find(m => m.id === id);
            if (!med) return;
            document.getElementById('medicineName').value = med.name;
            document.getElementById('medicineDosage').value = med.dosagem || '';
            // calcular dosagem sugerida
            const suggested = calculateDose(med);
            if (suggested) {
                // Campo dosagem removido, mas manter lÃ³gica para quantity e posology
                document.getElementById('medicineQuantity').value = suggested.quantityText || '';
                document.getElementById('medicinePosology').value = suggested.posology || '';
                // mostrar explicaÃ§Ã£o curta
                showDosageNote(suggested.note);
            }
            document.getElementById('medicineSuggestions').classList.remove('active');
        }

        function showDosageNote(text) {
            let note = document.getElementById('dosageNote');
            if (!note) {
                note = document.createElement('div');
                note.id = 'dosageNote';
                note.style.marginTop = '8px';
                note.style.fontSize = '13px';
                note.style.color = '#6b7280';
                document.getElementById('medicinesList').parentNode.insertBefore(note, document.getElementById('medicinesList'));
            }
            note.innerText = text || '';
        }

        // Helper: calcula doses por peso
        function calcularDosePorPeso(med, weight, dosesPerDay, defaultInterval, age, sex) {
            const doseMgRaw = med.adultDoseMgKg * weight;
            const dosePerDose = Math.min(doseMgRaw, med.maxPerDoseMg || doseMgRaw);
            const dosePerDoseRounded = Math.round(dosePerDose);

            let tabletsPerDose = null;
            let quantityText = `${dosesPerDay} doses/dia`;
            if (med.unitMg) {
                tabletsPerDose = Math.max(1, Math.round(dosePerDoseRounded / med.unitMg));
                const duration = med.defaultDurationDays || 7;
                const totalTablets = tabletsPerDose * dosesPerDay * duration;
                quantityText = `${totalTablets} comprimidos (por ${duration} dias)`;
            }

            const doseText = `${dosePerDoseRounded} mg (${med.adultDoseMgKg} mg/kg)`;
            const posology = med.unitMg ? `${tabletsPerDose} comprimido(s) de ${med.unitMg} mg a cada ${defaultInterval}h (${dosesPerDay}x/dia)` : `Tomar ${dosePerDoseRounded} mg a cada ${defaultInterval}h (${dosesPerDay}x/dia)`;

            let note = `SugestÃ£o baseada em peso (${weight} kg). Verificar contra-indicaÃ§Ãµes e ajuste por idade/insuficiÃªncia renal.`;
            if (!isNaN(age)) note += ` Idade: ${age} anos.`;
            if (sex) note += ` Sexo: ${sex}.`;

            return { doseText, quantityText, posology, note };
        }

        // Helper: calcula dose padrÃ£o
        function calcularDosePadrao(med, dosesPerDay, defaultInterval, age, sex) {
            const dosePerDose = med.standardDoseMg;
            const doseText = `${dosePerDose} mg (dose padrÃ£o)`;
            const duration = med.defaultDurationDays || 30;
            let quantityText = '';
            if (med.unitMg) {
                const tabletsPerDose = Math.max(1, Math.round(dosePerDose / med.unitMg));
                const totalTablets = tabletsPerDose * dosesPerDay * duration;
                quantityText = `${totalTablets} comprimidos (por ${duration} dias)`;
            }
            const posology = med.unitMg ? `${Math.max(1, Math.round(dosePerDose / med.unitMg))} comprimido(s) de ${med.unitMg} mg a cada ${defaultInterval}h (${dosesPerDay}x/dia)` : `Tomar ${dosePerDose} mg a cada ${defaultInterval}h (${dosesPerDay}x/dia)`;

            let note = `Dose padrÃ£o para adultos.`;
            if (!isNaN(age)) note += ` Idade: ${age} anos.`;
            if (sex) note += ` Sexo: ${sex}.`;
            return { doseText, quantityText, posology, note };
        }

        function calculateDose(med) {
            const weight = parseFloat(document.getElementById('patientWeight').value);
            const age = parseFloat(document.getElementById('patientAge').value);
            const sex = document.getElementById('patientSex').value;

            const defaultInterval = med.intervalHours || 8;
            let dosesPerDay = Math.round(24 / defaultInterval);
            if (dosesPerDay <= 0) dosesPerDay = 1;

            if (med.adultDoseMgKg && weight > 0) {
                return calcularDosePorPeso(med, weight, dosesPerDay, defaultInterval, age, sex);
            }

            if (med.standardDoseMg) {
                return calcularDosePadrao(med, dosesPerDay, defaultInterval, age, sex);
            }

            return null;
        }

        // CatÃ¡logo extenso de medicamentos (lista ilustrativa e nÃ£o-exaustiva ~220 itens)
        // Carregar medicamentos do JSON
        const loadMedicamentosFromJSON = () => {
            const medicamentos = [
  {
    "nome_medicacao": "Dipirona Monoidratada",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Paracetamol",
    "dosagem": "750 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ibuprofeno",
    "dosagem": "600 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Amoxicilina",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Amoxicilina + Clavulanato de PotÃ¡ssio",
    "dosagem": "875 mg + 125 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Azitromicina Di-hidratada",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Losartana PotÃ¡ssica",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Hidroclorotiazida",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sinvastatina",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Omeprazol",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cloridrato de Metformina",
    "dosagem": "850 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Maleato de Enalapril",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Captopril",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Atenolol",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Clonazepam",
    "dosagem": "2 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Alprazolam",
    "dosagem": "1 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cloridrato de Fluoxetina",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cloridrato de Sertralina",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Nimesulida",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Diclofenaco SÃ³dico",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Loratadina",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Maleato de Dexclorfeniramina",
    "dosagem": "2 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Prednisona",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Dexametasona",
    "dosagem": "4 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ãcido AcetilsalicÃ­lico",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Besilato de Anlodipino",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Furosemida",
    "dosagem": "40 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Espironolactona",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Levotiroxina SÃ³dica",
    "dosagem": "50 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Cloridrato de Tramadol",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Pantoprazol SÃ³dico Sesqui-hidratado",
    "dosagem": "40 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Domperidona",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cloridrato de Metoclopramida",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cefalexina",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cloridrato de Ciprofloxacino",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Metronidazol",
    "dosagem": "250 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Fluconazol",
    "dosagem": "150 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Albendazol",
    "dosagem": "400 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ivermectina",
    "dosagem": "6 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cloridrato de Amitriptilina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tadalafila",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Citrato de Sildenafila",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Finasterida",
    "dosagem": "1 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cloridrato de Tansulosina",
    "dosagem": "0.4 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Etinilestradiol + Levonorgestrel",
    "dosagem": "0.03 mg + 0.15 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sulfato Ferroso",
    "dosagem": "40 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ãcido FÃ³lico",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cloridrato de Ciclobenzaprina",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Carisoprodol",
    "dosagem": "300 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "IsotretinoÃ­na",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Paracetamol Gotas",
    "dosagem": "200 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Dipirona Gotas",
    "dosagem": "500 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Amoxicilina SuspensÃ£o",
    "dosagem": "250 mg/5ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Ibuprofeno SuspensÃ£o Oral",
    "dosagem": "100 mg/5ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Salbutamol Spray",
    "dosagem": "100 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Brometo de IpratrÃ³pio SoluÃ§Ã£o para InalaÃ§Ã£o",
    "dosagem": "0.25 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Insulina NPH",
    "dosagem": "100 UI/ml",
    "unidade": "UI/ml"
  },
  {
    "nome_medicacao": "Insulina Regular",
    "dosagem": "100 UI/ml",
    "unidade": "UI/ml"
  },
  {
    "nome_medicacao": "Heparina SÃ³dica",
    "dosagem": "5000 UI/ml",
    "unidade": "UI/ml"
  },
  {
    "nome_medicacao": "Enoxaparina SÃ³dica",
    "dosagem": "40 mg/0.4ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Varfarina SÃ³dica",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Clopidogrel",
    "dosagem": "75 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Rosuvastatina CÃ¡lcica",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Atorvastatina CÃ¡lcica",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ezetimiba",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Glibenclamida",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Gliclazida",
    "dosagem": "30 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Acarbose",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Pioglitazona",
    "dosagem": "30 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Alopurinol",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Carbamazepina",
    "dosagem": "200 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "FenitoÃ­na",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ãcido Valproico",
    "dosagem": "250 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Gabapentina",
    "dosagem": "300 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Pregabalina",
    "dosagem": "75 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Topiramato",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Lamotrigina",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Risperidona",
    "dosagem": "2 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Olanzapina",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Quetiapina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Haloperidol",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Carbonato de LÃ­tio",
    "dosagem": "300 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Escitalopram",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Citalopram",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Paroxetina",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Venlafaxina",
    "dosagem": "75 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Duloxetina",
    "dosagem": "30 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Bupropiona",
    "dosagem": "150 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Mirtazapina",
    "dosagem": "30 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Trazodona",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Diazepam",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Bromazepam",
    "dosagem": "3 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Lorazepam",
    "dosagem": "2 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Midazolam",
    "dosagem": "15 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Zolpidem",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Hidroxicloroquina",
    "dosagem": "400 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Metotrexato",
    "dosagem": "2.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Celecoxibe",
    "dosagem": "200 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Etoricoxibe",
    "dosagem": "90 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Meloxicam",
    "dosagem": "15 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Piroxicam",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tenoxicam",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "CodeÃ­na + Paracetamol",
    "dosagem": "30 mg + 500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tramadol + Paracetamol",
    "dosagem": "37.5 mg + 325 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Morfina",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Oxicodona",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Metadona",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Fentanila Adesivo TransdÃ©rmico",
    "dosagem": "25 mcg/h",
    "unidade": "mcg/h"
  },
  {
    "nome_medicacao": "Nitrato de Isossorbida",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Mononitrato de Isossorbida",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Propranolol",
    "dosagem": "40 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Carvedilol",
    "dosagem": "12.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Succinato de Metoprolol",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Bisoprolol",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Digoxina",
    "dosagem": "0.25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Amiodarona",
    "dosagem": "200 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Propafenona",
    "dosagem": "300 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sotalol",
    "dosagem": "160 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Verapamil",
    "dosagem": "80 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Diltiazem",
    "dosagem": "60 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Hidralazina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Metildopa",
    "dosagem": "250 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Clonidina",
    "dosagem": "0.100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Guaifenesina Xarope",
    "dosagem": "100 mg/5ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Ambroxol Xarope Adulto",
    "dosagem": "30 mg/5ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "CarbocisteÃ­na Xarope Infantil",
    "dosagem": "100 mg/5ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "AcetilcisteÃ­na Granulado",
    "dosagem": "600 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Montelucaste de SÃ³dio",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Fumarato de Formoterol + Budesonida",
    "dosagem": "12 mcg + 400 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Salmeterol + Fluticasona",
    "dosagem": "50 mcg + 250 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Bromoprida",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ondansetrona",
    "dosagem": "8 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Hioscina",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Loperamida",
    "dosagem": "2 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ranitidina",
    "dosagem": "150 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Famotidina",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "HidrÃ³xido de AlumÃ­nio + HidrÃ³xido de MagnÃ©sio",
    "dosagem": "60 mg/ml + 40 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Simeticona",
    "dosagem": "40 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Lactulose Xarope",
    "dosagem": "667 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Bisacodil",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Macrogol",
    "dosagem": "10 g",
    "unidade": "g"
  },
  {
    "nome_medicacao": "ColÃ­rio Nafazolina",
    "dosagem": "0.5 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "ColÃ­rio Tobramicina",
    "dosagem": "3 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "ColÃ­rio Hipromelose",
    "dosagem": "5 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "ColÃ­rio Travoprosta",
    "dosagem": "0.04 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Clotrimazol Creme",
    "dosagem": "10 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Miconazol Creme",
    "dosagem": "20 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Cetoconazol Shampoo",
    "dosagem": "20 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Nistatina SuspensÃ£o Oral",
    "dosagem": "100.000 UI/ml",
    "unidade": "UI/ml"
  },
  {
    "nome_medicacao": "Aciclovir Creme",
    "dosagem": "50 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Adapaleno Gel",
    "dosagem": "1 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "PerÃ³xido de BenzoÃ­la Gel",
    "dosagem": "50 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Hidroquinona Creme",
    "dosagem": "40 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Sulfadiazina de Prata Creme",
    "dosagem": "10 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Neomicina + Bacitracina Pomada",
    "dosagem": "5 mg/g + 250 UI/g",
    "unidade": "mg/g + UI/g"
  },
  {
    "nome_medicacao": "Valeriana Officinalis",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ginkgo Biloba",
    "dosagem": "80 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cinarizina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Betaistina",
    "dosagem": "16 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Donepezila",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Rivastigmina",
    "dosagem": "1.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Memantina",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Levodopa + Benserazida",
    "dosagem": "200 mg + 50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Pramipexol",
    "dosagem": "0.25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Biperideno",
    "dosagem": "2 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Secnidazol",
    "dosagem": "1000 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tinidazol",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Permetrina LoÃ§Ã£o",
    "dosagem": "50 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Deltametrina Shampoo",
    "dosagem": "0.2 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "PolivitamÃ­nico de A a Z",
    "dosagem": "1 comprimido",
    "unidade": "unidade"
  },
  {
    "nome_medicacao": "Carbonato de CÃ¡lcio + Vitamina D3",
    "dosagem": "500 mg + 400 UI",
    "unidade": "mg + UI"
  },
  {
    "nome_medicacao": "Cloreto de MagnÃ©sio",
    "dosagem": "33 g",
    "unidade": "g"
  },
  {
    "nome_medicacao": "ColÃ¡geno Hidrolisado",
    "dosagem": "10 g",
    "unidade": "g"
  },
  {
    "nome_medicacao": "Cefadroxila",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cefuroxima",
    "dosagem": "250 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ceftriaxona InjetÃ¡vel",
    "dosagem": "1 g",
    "unidade": "g"
  },
  {
    "nome_medicacao": "Clindamicina",
    "dosagem": "300 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Doxiciclina",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Levofloxacino",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Norfloxacino",
    "dosagem": "400 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "NitrofurantoÃ­na",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Penicilina G Benzatina InjetÃ¡vel",
    "dosagem": "1.200.000 UI",
    "unidade": "UI"
  },
  {
    "nome_medicacao": "Sulfametoxazol + Trimetoprima",
    "dosagem": "400 mg + 80 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tetraciclina",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Vancomicina InjetÃ¡vel",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Anfotericina B",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Itraconazol",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Terbinafina",
    "dosagem": "250 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Oseltamivir",
    "dosagem": "75 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Valaciclovir",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tenofovir",
    "dosagem": "300 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Lamivudina",
    "dosagem": "150 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Praziquantel",
    "dosagem": "600 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tibolona",
    "dosagem": "2.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Estradiol",
    "dosagem": "1 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Progesterona",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Testosterona Gel",
    "dosagem": "50 mg/5g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Dutasterida",
    "dosagem": "0.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Candesartana",
    "dosagem": "8 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Valsartana",
    "dosagem": "160 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Olmesartana",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Irbesartana",
    "dosagem": "150 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Lisinopril",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ramipril",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Indapamida",
    "dosagem": "1.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Clortalidona",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Rivaroxabana",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Apixabana",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Dabigatrana",
    "dosagem": "150 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ticagrelor",
    "dosagem": "90 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Prasugrel",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sacubitril + Valsartana",
    "dosagem": "24 mg + 26 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Dapagliflozina",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Empagliflozina",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sitagliptina",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Vildagliptina",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Linagliptina",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Liraglutida",
    "dosagem": "0.6 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Semaglutida",
    "dosagem": "1 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Risedronato SÃ³dico",
    "dosagem": "35 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ãcido IbandrÃ´nico",
    "dosagem": "150 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Raloxifeno",
    "dosagem": "60 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Teriparatida",
    "dosagem": "20 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Colchicina",
    "dosagem": "0.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Febuxostate",
    "dosagem": "80 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Hidroxizina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Desloratadina",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Levocetirizina",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Fexofenadina",
    "dosagem": "180 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Prometazina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Bilastina",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sumatriptana",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Naratriptana",
    "dosagem": "2.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Zolmitriptana",
    "dosagem": "2.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ergotamina + CafeÃ­na",
    "dosagem": "1 mg + 100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cloridrato de Metilfenidato",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Lisdexanfetamina",
    "dosagem": "30 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Atomoxetina",
    "dosagem": "40 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Aripiprazol",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ziprasidona",
    "dosagem": "40 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Paliperidona",
    "dosagem": "6 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Levomepromazina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Clorpromazina",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Flufenazina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tioridazina",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Imipramina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Clomipramina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Nortriptilina",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Maprotilina",
    "dosagem": "75 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Desvenlafaxina",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Agomelatina",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Reboxetina",
    "dosagem": "4 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Amantadina",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Selegilina",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Rasagilina",
    "dosagem": "1 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Entacapona",
    "dosagem": "200 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tolcapona",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ropinirol",
    "dosagem": "0.25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Mesalazina",
    "dosagem": "800 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sulfassalazina",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Azatioprina",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ciclosporina",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tacrolimo",
    "dosagem": "1 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Micofenolato de Mofetila",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Adalimumabe",
    "dosagem": "40 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Etanercepte",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Infliximabe",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Rituximabe",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Trastuzumabe",
    "dosagem": "150 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Bevacizumabe",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cetuximabe",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Pembrolizumabe",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Nivolumabe",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Capecitabina",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Imatinibe",
    "dosagem": "400 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Gefitinibe",
    "dosagem": "250 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Erlotinibe",
    "dosagem": "150 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sorafenibe",
    "dosagem": "200 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sunitinibe",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Pazopanibe",
    "dosagem": "400 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tamoxifeno",
    "dosagem": "20 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Anastrozol",
    "dosagem": "1 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Letrozol",
    "dosagem": "2.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Exemestano",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Bicalutamida",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Flutamida",
    "dosagem": "250 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Acetato de Ciproterona",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Acetato de Leuprorrelina",
    "dosagem": "3.75 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Goserelina",
    "dosagem": "3.6 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Fosfato de SÃ³dio de Prednisolona SoluÃ§Ã£o Oral",
    "dosagem": "1 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Hidrocortisona InjetÃ¡vel",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Metilprednisolona",
    "dosagem": "40 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Triancinolona Acetonida",
    "dosagem": "40 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Betametasona Creme",
    "dosagem": "1 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Desonida LoÃ§Ã£o",
    "dosagem": "0.5 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Mometasona Spray Nasal",
    "dosagem": "50 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Fluticasona Spray Nasal",
    "dosagem": "50 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Budesonida Capsula InalatÃ³ria",
    "dosagem": "200 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Ibuprofeno Gotas Infantil",
    "dosagem": "50 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Cefaclor SuspensÃ£o",
    "dosagem": "250 mg/5ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Sulfato de Salbutamol Xarope",
    "dosagem": "2 mg/5ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Levodropropizina Xarope",
    "dosagem": "30 mg/5ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Vitamina C Gotas",
    "dosagem": "200 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Vitamina D Gotas",
    "dosagem": "200 UI",
    "unidade": "UI"
  },
  {
    "nome_medicacao": "Cloreto de PotÃ¡ssio",
    "dosagem": "600 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Orlistate",
    "dosagem": "120 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sibutramina",
    "dosagem": "15 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tiamina (Vitamina B1)",
    "dosagem": "300 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Piridoxina (Vitamina B6)",
    "dosagem": "40 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Biotina",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Pentoxifilina",
    "dosagem": "400 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ginkgo Biloba",
    "dosagem": "120 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Diosmina + Hesperidina",
    "dosagem": "450 mg + 50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Casta-da-Ãndia",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Dropropizina Xarope",
    "dosagem": "1.5 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Cloperastina Xarope",
    "dosagem": "3.54 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Trimebutina",
    "dosagem": "200 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Pinaverio",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Racecadotrila",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Saccharomyces boulardii",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Metilcelulose",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Plantago ovata",
    "dosagem": "5 g",
    "unidade": "g"
  },
  {
    "nome_medicacao": "Alfaepoetina",
    "dosagem": "4000 UI",
    "unidade": "UI"
  },
  {
    "nome_medicacao": "Filgrastim",
    "dosagem": "300 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Somatropina",
    "dosagem": "12 UI",
    "unidade": "UI"
  },
  {
    "nome_medicacao": "Octreotida",
    "dosagem": "0.1 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Calcitonina Spray Nasal",
    "dosagem": "200 UI",
    "unidade": "UI"
  },
  {
    "nome_medicacao": "Alendronato de SÃ³dio",
    "dosagem": "70 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Pamidronato DissÃ³dico",
    "dosagem": "90 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ãcido ZoledrÃ´nico",
    "dosagem": "4 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Denosumabe",
    "dosagem": "60 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cinacalcete",
    "dosagem": "30 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Sevelamer",
    "dosagem": "800 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cloreto de CÃ¡lcio",
    "dosagem": "100 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Gliconato de CÃ¡lcio",
    "dosagem": "100 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Sulfato de MagnÃ©sio",
    "dosagem": "500 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Bicarbonato de SÃ³dio",
    "dosagem": "84 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Glicose 50%",
    "dosagem": "500 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Soro FisiolÃ³gico",
    "dosagem": "9 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Ãgua para InjeÃ§Ã£o",
    "dosagem": "10 ml",
    "unidade": "ml"
  },
  {
    "nome_medicacao": "Propofol",
    "dosagem": "10 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Etomidato",
    "dosagem": "2 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Cetamina",
    "dosagem": "50 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Succinilcolina",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "RocurÃ´nio",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "VecurÃ´nio",
    "dosagem": "10 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "LidocaÃ­na Geleia",
    "dosagem": "20 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "LidocaÃ­na InjetÃ¡vel",
    "dosagem": "20 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "BupivacaÃ­na",
    "dosagem": "5 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "RopivacaÃ­na",
    "dosagem": "7.5 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Norepinefrina",
    "dosagem": "1 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Epinefrina",
    "dosagem": "1 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Dobutamina",
    "dosagem": "12.5 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Nitroprussiato de SÃ³dio",
    "dosagem": "25 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Nitroglicerina",
    "dosagem": "5 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Isoprenalina",
    "dosagem": "0.2 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Atropina",
    "dosagem": "0.25 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Adenosina",
    "dosagem": "3 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Manitol SoluÃ§Ã£o",
    "dosagem": "200 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Imunoglobulina Humana",
    "dosagem": "5 g",
    "unidade": "g"
  },
  {
    "nome_medicacao": "Albumina Humana",
    "dosagem": "200 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Fator VIII de CoagulaÃ§Ã£o",
    "dosagem": "250 UI",
    "unidade": "UI"
  },
  {
    "nome_medicacao": "Fator IX de CoagulaÃ§Ã£o",
    "dosagem": "500 UI",
    "unidade": "UI"
  },
  {
    "nome_medicacao": "Complexo ProtrombÃ­nico",
    "dosagem": "500 UI",
    "unidade": "UI"
  },
  {
    "nome_medicacao": "Fitomenadiona (Vitamina K)",
    "dosagem": "10 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Protamina",
    "dosagem": "10 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Ãcido TranexÃ¢mico",
    "dosagem": "250 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Desmopressina",
    "dosagem": "4 mcg/ml",
    "unidade": "mcg/ml"
  },
  {
    "nome_medicacao": "Ocitocina",
    "dosagem": "5 UI/ml",
    "unidade": "UI/ml"
  },
  {
    "nome_medicacao": "Misoprostol",
    "dosagem": "25 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Metilergometrina",
    "dosagem": "0.2 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Alprostadil",
    "dosagem": "20 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Soro AntirrÃ¡bico",
    "dosagem": "1000 UI",
    "unidade": "UI"
  },
  {
    "nome_medicacao": "Soro AntitetÃ¢nico",
    "dosagem": "5000 UI",
    "unidade": "UI"
  },
  {
    "nome_medicacao": "Vacina TrÃ­plice Viral",
    "dosagem": "0.5 ml",
    "unidade": "ml"
  },
  {
    "nome_medicacao": "Vacina contra Influenza",
    "dosagem": "0.5 ml",
    "unidade": "ml"
  },
  {
    "nome_medicacao": "Vacina contra Hepatite B",
    "dosagem": "1 ml",
    "unidade": "ml"
  },
  {
    "nome_medicacao": "Vacina BCG",
    "dosagem": "0.1 ml",
    "unidade": "ml"
  },
  {
    "nome_medicacao": "Vacina contra HPV",
    "dosagem": "0.5 ml",
    "unidade": "ml"
  },
  {
    "nome_medicacao": "Vacina DTPa",
    "dosagem": "0.5 ml",
    "unidade": "ml"
  },
  {
    "nome_medicacao": "Vacina PneumocÃ³cica 13-valente",
    "dosagem": "0.5 ml",
    "unidade": "ml"
  },
  {
    "nome_medicacao": "Vacina contra RotavÃ­rus",
    "dosagem": "1.5 ml",
    "unidade": "ml"
  },
  {
    "nome_medicacao": "Vacina contra Febre Amarela",
    "dosagem": "0.5 ml",
    "unidade": "ml"
  },
  {
    "nome_medicacao": "CÃ¡lcio PolivitamÃ­nico",
    "dosagem": "600 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Glucosamina + Condroitina",
    "dosagem": "1.5 g + 1.2 g",
    "unidade": "g"
  },
  {
    "nome_medicacao": "Ãleo de Peixe (Ãmega 3)",
    "dosagem": "1000 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "ProbiÃ³tico",
    "dosagem": "5 BilhÃµes UFC",
    "unidade": "UFC"
  },

  {
    "nome_medicacao": "Dorzolamida + Timolol ColÃ­rio",
    "dosagem": "20 mg/ml + 5 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Bimatoprosta ColÃ­rio",
    "dosagem": "0.3 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Latanoprosta ColÃ­rio",
    "dosagem": "50 mcg/ml",
    "unidade": "mcg/ml"
  },
  {
    "nome_medicacao": "Ciclosporina ColÃ­rio",
    "dosagem": "0.5 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Diclofenaco ColÃ­rio",
    "dosagem": "1 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Cetoprofeno",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cetoprofeno Gotas",
    "dosagem": "20 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Naproxeno",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Aceclofenaco",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Etodolaco",
    "dosagem": "400 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Dexketoprofeno",
    "dosagem": "25 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Rifaximina",
    "dosagem": "550 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Fidaxomicina",
    "dosagem": "200 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Meropenem",
    "dosagem": "1 g",
    "unidade": "g"
  },
  {
    "nome_medicacao": "Imipenem + Cilastatina",
    "dosagem": "500 mg + 500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Tigeciclina",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Linezolida",
    "dosagem": "600 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Moxifloxacino",
    "dosagem": "400 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Claritromicina",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Telitromicina",
    "dosagem": "400 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Eritromicina",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Espamicina",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Rifampicina",
    "dosagem": "300 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Isoniazida",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Pirazinamida",
    "dosagem": "500 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Etambutol",
    "dosagem": "400 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Dapsona",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Clofazimina",
    "dosagem": "100 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Podofilina",
    "dosagem": "250 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Ãcido SalicÃ­lico",
    "dosagem": "200 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Ureia Creme",
    "dosagem": "100 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Tacrolimo Pomada",
    "dosagem": "0.3 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Pimecrolimo Creme",
    "dosagem": "10 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Calcipotriol",
    "dosagem": "50 mcg/g",
    "unidade": "mcg/g"
  },
  {
    "nome_medicacao": "Minoxidil",
    "dosagem": "50 mg/ml",
    "unidade": "mg/ml"
  },
  {
    "nome_medicacao": "Eflornitina",
    "dosagem": "115 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "TretinoÃ­na Creme",
    "dosagem": "0.25 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "IsotretinoÃ­na Gel",
    "dosagem": "0.5 mg/g",
    "unidade": "mg/g"
  },
  {
    "nome_medicacao": "Metilfenidato de LiberaÃ§Ã£o Prolongada",
    "dosagem": "18 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Zolpidem Sublingual",
    "dosagem": "5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Eszopiclona",
    "dosagem": "3 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ramelteona",
    "dosagem": "8 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Levonorgestrel",
    "dosagem": "1.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Ulipristal",
    "dosagem": "30 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Desogestrel",
    "dosagem": "75 mcg",
    "unidade": "mcg"
  },
  {
    "nome_medicacao": "Dispositivo Intrauterino de Cobre",
    "dosagem": "1 unidade",
    "unidade": "unidade"
  },
  {
    "nome_medicacao": "Dispositivo Intrauterino Hormonal",
    "dosagem": "52 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Implante de Etonogestrel",
    "dosagem": "68 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Anel Vaginal (Etonogestrel + Etinilestradiol)",
    "dosagem": "0.120 mg/dia + 0.015 mg/dia",
    "unidade": "mg/dia"
  },
  {
    "nome_medicacao": "Adesivo TransdÃ©rmico (Norelgestromina + Etinilestradiol)",
    "dosagem": "6 mg + 0.6 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Cabergolina",
    "dosagem": "0.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Bromocriptina",
    "dosagem": "2.5 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Clomifeno",
    "dosagem": "50 mg",
    "unidade": "mg"
  },
  {
    "nome_medicacao": "Gonadotrofina CoriÃ´nica Humana (hCG)",
    "dosagem": "5000 UI",
    "unidade": "UI"
  }
];
            applyMedicationsToMemory(medicamentos);
            return true;
        };

        const medicineCatalog = [
            'Paracetamol','Ibuprofeno','Dipirona','Amoxicilina','Azitromicina','Cefalexina','Ciprofloxacino','Levofloxacino','Claritromicina','Metronidazol',
            'Cefoxitina','Ceftriaxona','Cefuroxima','Doxiciclina','Tetraciclina','Clindamicina','Vancomicina','Linezolida','NitrofurantoÃ­na','Sulfametoxazol/Trimetoprim',
            'Losartana PotÃ¡ssica','Amlodipina','Enalapril','Captopril','Bramipril','Metoprolol','Propranolol','Carvedilol','Clonidina','Hidroclorotiazida',
            'Furosemida','Espironolactona','Atorvastatina','Sinvastatina','Rosuvastatina','Fenofibrato','Ezetimiba','Niacina','AAS (Ã¡cido acetilsalicÃ­lico)','Clopidogrel',
            'Prasugrel','Ticagrelor','Warfarina','Rivaroxabana','Apixabana','Dabigatrana','Heparina','Enoxaparina','Protamina','Digoxina',
            'Amiodarona','Sotalol','Diltiazem','Verapamil','Nifedipina','Isossorbida Mononitrato','Isossorbida Dinitrato','Nitroglicerina','Ivabradina','Aspirina',
            'Metformina','Gliclazida','Glimepirida','Insulina NPH','Insulina Regular','Insulina Detemir','Insulina Glargina','Sitagliptina','Saxagliptina','Empagliflozina',
            'Canagliflozina','Dapagliflozina','Pioglitazona','Rosiglitazona','Acarbose','Agmatina','Levotiroxina','Propiltiouracil','Metimazol','Carbimazol',
            'Omeprazol','Pantoprazol','Lansoprazol','Esomeprazol','Ranitidina','Famotidina','Sucralfato','Domperidona','Metoclopramida','Ondansetrona',
            'Prometazina','Meclizina','Loperamida','Macrogol','Bisacodil','Senna','Salmeterol','Formoterol','IpratrÃ³pio','Budesonida',
            'Beclometasona','Fluticasona','Montelucaste','Prednisolona','Dexametasona','Hidrocortisona','Metilprednisolona','Brometo de TiotrÃ³pio','Tiotropio','Aclidinio',
            'Cetirizina','Loratadina','Desloratadina','Fexofenadina','Levocetirizina','Risperidona','Olanzapina','Quetiapina','Haloperidol','Clorpromazina',
            'Diazepam','Clonazepam','Lorazepam','Alprazolam','Buspirona','Fluoxetina','Sertralina','Paroxetina','Escitalopram','Citalopram',
            'Valproato','Carbamazepina','Lamotrigina','Levetiracetam','Topiramato','Gabapentina','Pregabalina','Lithium','Metilfenidato','Atomoxetina',
            'Sildenafil','Tadalafil','Vardenafil','Finasterida','Dutasterida','Tamsulosina','Silodosina','Alprostadil','Bicalutamida','Anastrozol',
            'Letrozol','Tamoxifeno','Trastuzumabe','Bevacizumabe','Cetuximabe','Methotrexato','Ciclosporina','Tacrolimo','Azatioprina','Micofenolato',
            'Prednisona','Metotrexato','Colchicina','Alopurinol','Febuxostate','Probenecida','Allopurinol','Naproxeno','Piroxicam','Celecoxibe',
            'Ketorolaco','Tramadol','CodeÃ­na','Morfina','Oxicodona','Fentanil','Buprenorfina','Metadona','Gabapentina','Pregabalina',
            'Amoxicilina/Clavulanato','Cefazolina','Cefoperazona','Cefepima','Meropenem','Imipenem','Ertapenem','Polimixina','Colistina','Rifampicina',
            'Isoniazida','Pirazinamida','Etambutol','Pirazinamida','Isoniazida','Rifabutina','Rifapentina','Lamivudina','Zidovudina','Tenofovir',
            'Efavirenz','Dolutegravir','Raltegravir','Atazanavir','Darunavir','Lopinavir/Ritonavir','Prednisolona (inalatÃ³ria)','Bromexina','Ambroxol','AcetilcisteÃ­na',
            'Vitamina D','Vitamina B12','Ãcido FÃ³lico','Ferro SÃ©rico','Complexo B','Vitamina C','CÃ¡lcio Carbonato','Carbonato de MagnÃ©sio','Sulfato de Zinco','Selenium',
            'Cloreto de PotÃ¡ssio','SoluÃ§Ã£o Ringer','Colchicina','Hidroclorotiazida','Clortalidona','Metolazona','Spironolactona','Eplerenona','Amilorida','Triamtereno',
            'Naproxeno','Celecoxibe','Meloxicam','Etoricoxibe','Tizanidina','Baclofeno','Ciclobenzaprina','Metocarbamol','Duloxetina','Milnaciprano',
            'Losartana/Hidroclorotiazida','Enalapril/Hidroclorotiazida','Fentanil TTS','Oxicodona/Naloxona','Cetoconazol','Fluconazol','Itraconazol','Voriconazol','Anfotericina B','Nystatina',
            'Metformina XR','Semaglutida','Liraglutida','Insulina Lispro','Insulina Aspart','Insulina Degludec','Exenatida','Dapagliflozina/Metformina','Empagliflozina/Metformina','Sitagliptina/Metformina'
        ];

        // CatÃ¡logos de exames por categoria (listas padrÃ£o)
        const examCatalogs = {
            crianca: [
                "Hemograma Completo", "ParasitolÃ³gico de Fezes", "Urina Tipo I", "Glicemia de Jejum", "ParasitolÃ³gico de Fezes (MÃ©todo Hoffman)",
                "Coprocultura", "Ureia", "Creatinina", "Transaminases (TGO/TGP)", "Bilirrubinas Totais e Fracionadas",
                "Fosfatase Alcalina", "Gama GT", "Colesterol Total", "TriglicerÃ­deos", "HDL-Colesterol", "LDL-Colesterol",
                "Vitamina D", "Ferro SÃ©rico", "Ferritina", "Calcio Total", "FÃ³sforo", "MagnÃ©sio", "SÃ³dio", "PotÃ¡ssio", "Cloro",
                "TSH", "T4 Livre", "T3 Total", "ParatormÃ´nio (PTH)", "ProteÃ­na C Reativa (PCR)", "Fator Reumatoide",
                "Anticorpos Anti-DNA", "Complemento C3", "Complemento C4", "Hemocultura", "Urocultura", "Coprocultura",
                "Cultura de Escarro", "Teste do Pezinho Ampliado", "Triagem Neonatal", "Audiometria", "Eletroencefalograma (EEG)",
                "Ecocardiograma", "Ultrassonografia Abdominal", "Ultrassonografia PÃ©lvica", "Raio-X de TÃ³rax", "Raio-X de Ossos",
                "Densitometria Ãssea", "Tomografia Computadorizada (TC)", "RessonÃ¢ncia MagnÃ©tica (RM)"
            ],
            adolescente: [
                "Hemograma Completo", "ParasitolÃ³gico de Fezes", "Urina Tipo I", "Glicemia de Jejum", "Curva GlicÃªmica",
                "Hemoglobina Glicada (HbA1c)", "ParasitolÃ³gico de Fezes (MÃ©todo Hoffman)", "Coprocultura", "Ureia", "Creatinina",
                "Transaminases (TGO/TGP)", "Bilirrubinas Totais e Fracionadas", "Fosfatase Alcalina", "Gama GT", "Colesterol Total",
                "TriglicerÃ­deos", "HDL-Colesterol", "LDL-Colesterol", "Vitamina D", "Ferro SÃ©rico", "Ferritina", "Calcio Total",
                "FÃ³sforo", "MagnÃ©sio", "SÃ³dio", "PotÃ¡ssio", "Cloro", "TSH", "T4 Livre", "T3 Total", "ParatormÃ´nio (PTH)",
                "ProteÃ­na C Reativa (PCR)", "Fator Reumatoide", "Anticorpos Anti-DNA", "Complemento C3", "Complemento C4",
                "Hemocultura", "Urocultura", "Coprocultura", "Cultura de Escarro", "Teste de Gravidez", "Beta-HCG",
                "HormÃ´nio FolÃ­culo Estimulante (FSH)", "HormÃ´nio Luteinizante (LH)", "Prolactina", "Testosterona Total",
                "Testosterona Livre", "Estradiol", "Progesterona", "Cortisol", "ACTH", "Audiometria", "Eletroencefalograma (EEG)",
                "Ecocardiograma", "Ultrassonografia Abdominal", "Ultrassonografia PÃ©lvica", "Ultrassonografia Transvaginal",
                "Raio-X de TÃ³rax", "Raio-X de Ossos", "Mamografia", "Densitometria Ãssea", "Tomografia Computadorizada (TC)",
                "RessonÃ¢ncia MagnÃ©tica (RM)"
            ],
            mulher: [
                "Hemograma Completo", "ParasitolÃ³gico de Fezes", "Urina Tipo I", "Glicemia de Jejum", "Curva GlicÃªmica",
                "Hemoglobina Glicada (HbA1c)", "ParasitolÃ³gico de Fezes (MÃ©todo Hoffman)", "Coprocultura", "Ureia", "Creatinina",
                "Transaminases (TGO/TGP)", "Bilirrubinas Totais e Fracionadas", "Fosfatase Alcalina", "Gama GT", "Colesterol Total",
                "TriglicerÃ­deos", "HDL-Colesterol", "LDL-Colesterol", "Vitamina D", "Ferro SÃ©rico", "Ferritina", "Calcio Total",
                "FÃ³sforo", "MagnÃ©sio", "SÃ³dio", "PotÃ¡ssio", "Cloro", "TSH", "T4 Livre", "T3 Total", "ParatormÃ´nio (PTH)",
                "ProteÃ­na C Reativa (PCR)", "Fator Reumatoide", "Anticorpos Anti-DNA", "Complemento C3", "Complemento C4",
                "Hemocultura", "Urocultura", "Coprocultura", "Cultura de Escarro", "Teste de Gravidez", "Beta-HCG",
                "HormÃ´nio FolÃ­culo Estimulante (FSH)", "HormÃ´nio Luteinizante (LH)", "Prolactina", "Testosterona Total",
                "Testosterona Livre", "Estradiol", "Progesterona", "Cortisol", "ACTH", "CA-125", "CA-15.3", "CEA",
                "Audiometria", "Eletroencefalograma (EEG)", "Ecocardiograma", "Ultrassonografia Abdominal", "Ultrassonografia PÃ©lvica",
                "Ultrassonografia Transvaginal", "Ultrassonografia MamÃ¡ria", "Raio-X de TÃ³rax", "Raio-X de Ossos", "Mamografia",
                "Densitometria Ãssea", "Colposcopia", "Papanicolau", "Tomografia Computadorizada (TC)", "RessonÃ¢ncia MagnÃ©tica (RM)",
                "RessonÃ¢ncia MagnÃ©tica MamÃ¡ria"
            ],
            homem: [
                "Hemograma Completo", "ParasitolÃ³gico de Fezes", "Urina Tipo I", "Glicemia de Jejum", "Curva GlicÃªmica",
                "Hemoglobina Glicada (HbA1c)", "ParasitolÃ³gico de Fezes (MÃ©todo Hoffman)", "Coprocultura", "Ureia", "Creatinina",
                "Transaminases (TGO/TGP)", "Bilirrubinas Totais e Fracionadas", "Fosfatase Alcalina", "Gama GT", "Colesterol Total",
                "TriglicerÃ­deos", "HDL-Colesterol", "LDL-Colesterol", "Vitamina D", "Ferro SÃ©rico", "Ferritina", "Calcio Total",
                "FÃ³sforo", "MagnÃ©sio", "SÃ³dio", "PotÃ¡ssio", "Cloro", "TSH", "T4 Livre", "T3 Total", "ParatormÃ´nio (PTH)",
                "ProteÃ­na C Reativa (PCR)", "Fator Reumatoide", "Anticorpos Anti-DNA", "Complemento C3", "Complemento C4",
                "Hemocultura", "Urocultura", "Coprocultura", "Cultura de Escarro", "PSA Total", "PSA Livre",
                "AntÃ­geno ProstÃ¡tico EspecÃ­fico (PSA)", "Testosterona Total", "Testosterona Livre", "Cortisol", "ACTH",
                "Audiometria", "Eletroencefalograma (EEG)", "Ecocardiograma", "Ultrassonografia Abdominal", "Ultrassonografia ProstÃ¡tica",
                "Raio-X de TÃ³rax", "Raio-X de Ossos", "Densitometria Ãssea", "Tomografia Computadorizada (TC)", "RessonÃ¢ncia MagnÃ©tica (RM)"
            ]
        };

        async function openMedicineModal() {
            // Carregar medicamentos do JSON embutido
            loadMedicamentosFromJSON();
            
            // Tentativa automÃ¡tica de carregar catÃ¡logo grande da pasta medicacoes
            // Nota: quando hospedado em GitHub Pages o site pode estar em um subdiretÃ³rio
            // (ex: /<user>/<repo>/). ConstruÃ­mos a URL base de forma robusta e permitimos
            // que o usuÃ¡rio sobrescreva via campo #externalMedUrl.
            async function tryLoadMedicaments(paths) {
                for (const p of paths) {
                    if (!p) continue;
                    try {
                        const resp = await fetch(p);
                        if (resp.ok) {
                            const data = await resp.json();
                            applyMedicationsToMemory(data);
                            return true;
                        }
                    } catch (err) {
                        // ignorar e tentar prÃ³ximo caminho
                        console.debug('Falha ao carregar', p, err.message || err);
                    }
                }
                return false;
            }

            // detecta base path do site (tratando cases como GitHub Pages hospedado em /repo/)
            const base = (function(){
                try {
                    // document.baseURI jÃ¡ dÃ¡ a URL completa; transformamos em caminho relativo ao host
                    const url = new URL(document.baseURI || window.location.href);
                    return url.pathname.replace(/\/index\.html$|\/$/, '/') || '/';
                } catch(e) {
                    return '/';
                }
            })();

            // caminhos a tentar, em ordem: campo configurÃ¡vel, caminho relativo simples e caminho ajustado ao base
            const configured = (document.getElementById('externalMedUrl') && document.getElementById('externalMedUrl').value) || '';
            const candidates = [
                configured,
                'medicacoes/medicamentos_full.json',
                'medicacoes/medicamentos.json',
                base.replace(/\/$/, '') + '/medicacoes/medicamentos_full.json',
                base.replace(/\/$/, '') + '/medicacoes/medicamentos.json'
            ].map(s => s ? s : null).filter(Boolean);

            // registrar tentativas para debug/visualizaÃ§Ã£o
            window._medicineLoadAttempts = [];
            async function tryLoadWithLogging(paths) {
                for (const p of paths) {
                    window._medicineLoadAttempts.push(p);
                }
                return await tryLoadMedicaments(paths);
            }

            try {
                const ok = await tryLoadWithLogging(candidates);
                if (!ok) console.debug('NÃ£o foi possÃ­vel carregar automaticamente o catÃ¡logo grande: nenhum dos caminhos funcionou');
            } catch (err) {
                console.debug('Erro inesperado ao tentar carregar catÃ¡logo:', err.message || err);
            }

            populateMedicineModal();
            document.getElementById('medicineModal').classList.add('active');
            document.getElementById('medicineModal').setAttribute('aria-hidden','false');
        }

        function closeMedicineModal() {
            document.getElementById('medicineModal').classList.remove('active');
            document.getElementById('medicineModal').setAttribute('aria-hidden','true');
        }

        // FunÃ§Ãµes para modal de exames
        async function openExamModal() {
            document.getElementById('examModal').classList.add('active');
            document.getElementById('examModal').setAttribute('aria-hidden','false');
        }

        function closeExamModal() {
            document.getElementById('examModal').classList.remove('active');
            document.getElementById('examModal').setAttribute('aria-hidden','true');
        }

        async function loadExamCategory(category) {
            const pathMap = {
                'crianca': 'exames.crianca/exames_crianca.json',
                'adolescente': 'exames.adolescente/exames_adolescente.json',
                'mulher': 'exames.mulher/exames_mulher.json',
                'homem': 'exames.homem/exames_homem.json'
            };

            try {
                const response = await fetch(pathMap[category]);
                if (response.ok) {
                    const exams = await response.json();
                    window.currentExamCatalog = exams;
                    populateExamModal(exams);
                } else {
                    throw new Error('Response not ok');
                }
            } catch (error) {
                console.warn('NÃ£o foi possÃ­vel carregar exames de arquivo, usando lista padrÃ£o:', error.message);
                // Usar lista padrÃ£o se fetch falhar
                const exams = examCatalogs[category] || [];
                window.currentExamCatalog = exams;
                populateExamModal(exams);
            }
        }

        function populateExamModal(exams) {
            const container = document.getElementById('modalExamList');
            if (!container) return;
            container.innerHTML = '';

            if (!exams || exams.length === 0) {
                container.innerHTML = '<p style="color:#6b7280; text-align:center;">Nenhum exame disponÃ­vel.</p>';
                return;
            }

            const frag = document.createDocumentFragment();
            exams.forEach((exam, i) => {
                const id = `modal-exam-${i}`;
                const wrapper = document.createElement('div');
                wrapper.style.display = 'flex';
                wrapper.style.alignItems = 'center';
                wrapper.style.gap = '10px';
                wrapper.style.padding = '6px 4px';

                const input = document.createElement('input');
                input.type = 'checkbox';
                input.id = id;
                input.setAttribute('data-name', exam);

                const label = document.createElement('label');
                label.htmlFor = id;
                label.textContent = exam;

                wrapper.appendChild(input);
                wrapper.appendChild(label);
                frag.appendChild(wrapper);
            });

            container.appendChild(frag);
        }

        function filterExamModal(query) {
            const container = document.getElementById('modalExamList');
            const items = container.querySelectorAll('div');
            const filter = query.toLowerCase();

            items.forEach(item => {
                const label = item.querySelector('label');
                if (label) {
                    const text = label.textContent.toLowerCase();
                    item.style.display = text.includes(filter) ? 'flex' : 'none';
                }
            });
        }

        function addSelectedExams() {
            const checkboxes = document.querySelectorAll('#modalExamList input[type="checkbox"]:checked');
            let addedCount = 0;

            checkboxes.forEach(checkbox => {
                const examName = checkbox.getAttribute('data-name');
                if (examName) {
                    // Adicionar o exame usando a funÃ§Ã£o existente addExam
                    document.getElementById('examName').value = examName;
                    addExam();
                    addedCount++;
                }
            });

            if (addedCount > 0) {
                alert(`${addedCount} exame(s) adicionado(s) com sucesso.`);
                closeExamModal();
            } else {
                alert('Nenhum exame selecionado.');
            }
        }

        function addMedicine() {
            let name = document.getElementById('medicineName').value.trim();
            let dosage = document.getElementById('medicineDosage').value.trim();
            let quantity = document.getElementById('medicineQuantity').value.trim();
            let posology = document.getElementById('medicinePosology').value.trim();

            if (!name) {
                alert('Por favor, digite o nome do medicamento.');
                return;
            }

            // tentar achar metadados do medicamento para preencher automaticamente se nÃ£o preenchido
            const med = medicines.find(m => m.name.toLowerCase() === name.toLowerCase());
            if (med && !dosage) {
                const suggested = calculateDose(med);
                if (suggested) {
                    dosage = suggested.doseText || med.dosagem || '';
                    if (!quantity) quantity = suggested.quantityText || '';
                    if (!posology) posology = suggested.posology || '';
                    showDosageNote(suggested.note);
                } else {
                    dosage = med.dosagem || '';
                }
            }

            const medicinesList = document.getElementById('medicinesList');
            
            // Remover mensagem de lista vazia
            if (medicinesList.querySelector('p')) {
                medicinesList.innerHTML = '';
            }

            const medicineItem = document.createElement('div');
            medicineItem.className = 'medicine-item';
            // armazenar atributos para uso posterior/preview
            medicineItem.setAttribute('data-name', name);
            medicineItem.setAttribute('data-dosage', dosage);
            medicineItem.setAttribute('data-quantity', quantity);
            medicineItem.setAttribute('data-posology', posology);

            medicineItem.innerHTML = `
                <div class="medicine-info">
                    <strong>${name}</strong><br>
                    <small>Dosagem: ${dosage} | Quantidade: ${quantity} | Posologia: ${posology}</small>
                </div>
                <button class="btn btn-danger" onclick="removeItem(this)" style="padding: 8px 16px; font-size: 14px;">Remover</button>
            `;

            medicinesList.appendChild(medicineItem);

            // Limpar campos
            document.getElementById('medicineName').value = '';
            document.getElementById('medicineDosage').value = '';
            document.getElementById('medicineQuantity').value = '';
            document.getElementById('medicinePosology').value = '';
        }
        
        // Adicionar medicamentos selecionados no modal (batch)
        function addSelectedMedicines() {
            const checks = Array.from(document.querySelectorAll('#modalMedicineList input[type="checkbox"]:checked'));
            checks.forEach(ch => {
                const name = ch.getAttribute('data-name');
                // preencher campos e adicionar
                document.getElementById('medicineName').value = name;
                // tentar achar med no banco para calcular dosagem
                const med = medicines.find(x => x.name.toLowerCase() === name.toLowerCase());
                if (med) {
                    document.getElementById('medicineDosage').value = med.dosagem || '';
                    const suggested = calculateDose(med);
                    if (suggested) {
                        // Campo dosagem removido, mas manter quantity e posology
                        document.getElementById('medicineQuantity').value = suggested.quantityText || '';
                        document.getElementById('medicinePosology').value = suggested.posology || '';
                        showDosageNote(suggested.note);
                    }
                }
                addMedicine();
            });
            closeMedicineModal();
        }

        // Busca de exames (simulada)
        const exams = [
            'Hemograma Completo', 'Glicemia de Jejum', 'Colesterol Total', 'TriglicerÃ­deos',
            'Creatinina', 'Ureia', 'TSH', 'T4 Livre', 'Urina Tipo I', 'ParasitolÃ³gico de Fezes',
            'Eletrocardiograma', 'Ecocardiograma', 'Raio X de TÃ³rax', 'Ultrassonografia Abdominal',
            'Mamografia', 'Papanicolau', 'Colonoscopia', 'Endoscopia Digestiva'
        ];

        function searchExam(query) {
            const suggestions = document.getElementById('examSuggestions');
            if (query.length < 2) {
                suggestions.classList.remove('active');
                return;
            }

            const filtered = exams.filter(exam => 
                exam.toLowerCase().includes(query.toLowerCase())
            );

            if (filtered.length > 0) {
                suggestions.innerHTML = filtered.map(exam => 
                    `<div class="suggestion-item" onclick="selectExam('${exam}')">${exam}</div>`
                ).join('');
                suggestions.classList.add('active');
            } else {
                suggestions.classList.remove('active');
            }
        }

        function selectExam(name) {
            document.getElementById('examName').value = name;
            document.getElementById('examSuggestions').classList.remove('active');
        }

        // Fechar sugestÃµes ao clicar fora
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.search-box')) {
                document.querySelectorAll('.autocomplete-suggestions').forEach(sugg => {
                    sugg.classList.remove('active');
                });
            }
        });

        // --- Suporte para carregar medicaÃ§Ãµes externas ---
        async function loadExternalMedications() {
            const url = document.getElementById('externalMedUrl').value.trim();
            if (!url) {
                alert('Informe a URL/ caminho do arquivo de medicaÃ§Ãµes.');
                return;
            }

            try {
                const resp = await fetch(url);
                if (!resp.ok) throw new Error('Falha ao carregar arquivo (status ' + resp.status + ')');
                const data = await resp.json();
                applyMedicationsToMemory(data);
                alert('Lista de medicamentos carregada com sucesso.');
            } catch (err) {
                alert('NÃ£o foi possÃ­vel carregar via fetch. Se estiver usando file://, use o upload manual. Erro: ' + err.message);
                console.error(err);
            }
        }

        function handleMedFileUpload(files) {
            if (!files || files.length === 0) return;
            const file = files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                try {
                    if (file.name.toLowerCase().endsWith('.json')) {
                        const data = JSON.parse(text);
                        applyMedicationsToMemory(data);
                        alert('Arquivo JSON importado com sucesso.');
                    } else {
                        // tentar CSV
                        const meds = parseCSVToMeds(text);
                        applyMedicationsToMemory(meds);
                        alert('Arquivo CSV importado com sucesso.');
                    }
                } catch (err) {
                    alert('Erro ao processar arquivo: ' + err.message);
                    console.error(err);
                }
            };
            reader.readAsText(file, 'UTF-8');
        }

        function parseCSVToMeds(csvText) {
            // CSV simples: header linha com pelo menos 'name' ou 'id'
            const lines = csvText.split(/\r?\n/).map(l => l.trim()).filter(Boolean);
            if (lines.length === 0) return [];
            const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
            const rows = lines.slice(1);
            const meds = rows.map(r => {
                const cols = r.split(',').map(c => c.trim());
                const obj = {};
                headers.forEach((h, i) => {
                    obj[h] = cols[i] || '';
                });
                // converter campos numÃ©ricos quando aplicÃ¡vel
                if (obj.adultdosemgkg) obj.adultDoseMgKg = parseFloat(obj.adultdosemgkg);
                if (obj.unitmg) obj.unitMg = parseFloat(obj.unitmg);
                if (obj.defaultdurationdays) obj.defaultDurationDays = parseInt(obj.defaultdurationdays, 10);
                if (obj.maxperdosemg) obj.maxPerDoseMg = parseFloat(obj.maxperdosemg);
                if (obj.maxperdaymg) obj.maxPerDayMg = parseFloat(obj.maxperdaymg);
                // garantir nome/ id
                if (!obj.name && obj.id) obj.name = obj.id;
                return obj;
            });
            return meds;
        }

        function applyMedicationsToMemory(list) {
            if (!Array.isArray(list)) {
                throw new Error('Formato invÃ¡lido: espera array de objetos');
            }
            // normalizar e substituir arrays em memÃ³ria
            const normalized = list.map(item => {
                // Extrair valor numÃ©rico da dosagem
                let standardDoseMg = null;
                if (item.dosagem) {
                    const match = item.dosagem.match(/(\d+(\.\d+)?)/);
                    if (match) {
                        standardDoseMg = parseFloat(match[1]);
                    }
                }
                
                // Definir unitMg baseado na unidade
                let unitMg = null;
                if (item.unidade === 'mg' && standardDoseMg) {
                    unitMg = standardDoseMg; // Assumir que a dosagem Ã© por unidade
                }
                
                return {
                    id: item.id || (item.nome_medicacao ? item.nome_medicacao.toLowerCase().replace(/\s+/g,'_') : Math.random().toString(36).slice(2,8)),
                    name: item.nome_medicacao || item.name || '',
                    type: item.type || item.category || '',
                    adultDoseMgKg: item.adultDoseMgKg || item.adultdosemgkg || null,
                    maxPerDoseMg: item.maxPerDoseMg || item.maxperdosemg || null,
                    maxPerDayMg: item.maxPerDayMg || item.maxperdaymg || null,
                    standardDoseMg: item.standardDoseMg || item.standarddosemg || standardDoseMg,
                    unitMg: item.unitMg || item.unitmg || unitMg,
                    defaultDurationDays: item.defaultDurationDays || item.defaultdurationdays || null,
                    dosagem: item.dosagem || '',
                    unidade: item.unidade || ''
                };
            });

            // substituir arrays globais e variÃ¡veis locais usadas pelo cÃ³digo
            window.medicines = normalized;
            // tambÃ©m atualizar a variÃ¡vel 'medicines' (const no topo) para que buscas e seleÃ§Ãµes
            // usem imediatamente os dados recÃ©m-carregados
            try { medicines.length = 0; medicines.push(...normalized); } catch(e) { window.medicines = normalized; }
            window.medicineCatalog = normalized.map(m => m.name).filter(Boolean);
            try { medicineCatalog.length = 0; medicineCatalog.push(...window.medicineCatalog); } catch(e) { window.medicineCatalog = window.medicineCatalog; }
            // atualizar modal se estiver aberto
            if (document.getElementById('medicineModal').classList.contains('active')) {
                populateMedicineModal();
            }
        }

        // Popula o modal com a lista atual de medicamentos (vinda de window.medicineCatalog ou medicineCatalog)
        function populateMedicineModal() {
            const container = document.getElementById('modalMedicineList');
            if (!container) return;
            container.innerHTML = '';

            // preferir catÃ¡logo em memÃ³ria, poi pode ter sido carregado via arquivo
            let list = [];
            let source = 'embutida';
            if (window.medicineCatalog && Array.isArray(window.medicineCatalog) && window.medicineCatalog.length > 0) {
                list = window.medicineCatalog;
                source = 'externa (memÃ³ria)';
            } else if (Array.isArray(medicineCatalog)) {
                list = medicineCatalog;
                source = 'embutida';
            }

            // Se lista vazia, mostrar mensagem
            if (list.length === 0) {
                container.innerHTML = '<p style="color:#6b7280; text-align:center;">Nenhum medicamento disponÃ­vel. Importe ou gere a lista em ConfiguraÃ§Ãµes.</p>';
                return;
            }

            const frag = document.createDocumentFragment();
            list.forEach((m, i) => {
                const id = `modal-med-${i}`;
                const wrapper = document.createElement('div');
                wrapper.style.display = 'flex';
                wrapper.style.alignItems = 'center';
                wrapper.style.gap = '10px';
                wrapper.style.padding = '6px 4px';

                const input = document.createElement('input');
                input.type = 'checkbox';
                input.id = id;
                input.setAttribute('data-name', m);

                const label = document.createElement('label');
                label.htmlFor = id;
                label.textContent = m;

                wrapper.appendChild(input);
                wrapper.appendChild(label);
                frag.appendChild(wrapper);
            });

            container.appendChild(frag);

            // debug info removed by user request
        }

        async function forceReloadMedicaments() {
            const url = document.getElementById('externalMedUrl') ? document.getElementById('externalMedUrl').value.trim() : '';
            const toTry = [];
            if (url) toTry.push(url);
            // tambÃ©m tentar caminhos comuns
            toTry.push('medicacoes/medicamentos_full.json', 'medicacoes/medicamentos.json');
            window._medicineLoadAttempts = [];
            try {
                const ok = await (async function(paths){
                    for (const p of paths) {
                        window._medicineLoadAttempts.push(p);
                        try {
                            const r = await fetch(p);
                            if (r.ok) {
                                const d = await r.json();
                                applyMedicationsToMemory(d);
                                return true;
                            }
                        } catch(e) {
                            console.debug('forceReload falhou ao buscar', p, e.message || e);
                        }
                    }
                    return false;
                })(toTry);

                if (ok) {
                    populateMedicineModal();
                    alert('Lista de medicamentos carregada com sucesso.');
                } else {
                    // Tentativa automÃ¡tica falhou â pode ser por estar abrindo via file://
                    console.debug('NÃ£o foi possÃ­vel carregar automaticamente o catÃ¡logo grande: nenhum dos caminhos funcionou');
                    alert('NÃ£o foi possÃ­vel carregar a lista externa automaticamente. Se estiver abrindo o arquivo localmente, selecione o arquivo medicacoes/medicamentos_full.json no seletor que serÃ¡ aberto.');
                    const upload = document.getElementById('uploadMeds');
                    if (upload) {
                        try { upload.click(); } catch(e) { console.debug('Falha ao tentar abrir seletor de arquivo automaticamente', e); }
                    }
                    populateMedicineModal();
                }
            } catch(e) {
                console.debug('Erro em forceReloadMedicaments:', e.message || e);
                alert('Erro ao tentar carregar a lista externa. Veja console para detalhes.');
            }
        }

        function resetToBuiltin() {
            // recarrega a pÃ¡gina para restaurar os valores embutidos
            if (confirm('Deseja recarregar a pÃ¡gina para restaurar a lista embutida?')) {
                window.location.reload();
            }
        }

        // Gera um catÃ¡logo padronizado com 'count' entradas (para geraÃ§Ã£o local)
        function generateCatalog(count) {
            const baseTypes = ['analgÃ©sico','antibiÃ³tico','antifÃºngico','antiviral','antihipertensivo','antidiabÃ©tico','psicotrÃ³pico','anti-inflamatÃ³rio','antialÃ©rgico','gastroprotetor'];
            const units = [50,100,125,150,200,250,300,400,500];
            const catalog = [];
            for (let i = 1; i <= count; i++) {
                const name = `MedicaÃ§Ã£o ${i}`;
                const id = `med_${i}`;
                const type = baseTypes[i % baseTypes.length];
                const unitMg = units[i % units.length];
                const defaultDurationDays = (i % 2 === 0) ? 7 : 14;
                const obj = {
                    id,
                    name,
                    type,
                    unitMg,
                    defaultDurationDays
                };
                // para algumas entradas, adicionar adultDoseMgKg para permitir cÃ¡lculo
                if (i % 3 === 0) {
                    obj.adultDoseMgKg = 10 + (i % 6); // 10-15 mg/kg
                    obj.maxPerDoseMg = Math.max(200, obj.adultDoseMgKg * 70);
                    obj.maxPerDayMg = obj.maxPerDoseMg * 3;
                } else if (i % 5 === 0) {
                    obj.standardDoseMg = unitMg * Math.max(1, Math.round((50 + (i%100)) / unitMg));
                }
                catalog.push(obj);
            }
            return catalog;
        }

        function generateAndDownloadCatalog() {
            const count = parseInt(document.getElementById('generateCount').value, 10) || 3000;
            if (!confirm(`Gerar e baixar catÃ¡logo com ${count} medicaÃ§Ãµes? Isso pode gerar um arquivo grande.`)) return;
            const data = generateCatalog(count);
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `medicacoes_medicos_catalog_${count}.json`;
            document.body.appendChild(a);
            a.click();
            a.remove();
            URL.revokeObjectURL(url);
        }

        // --- Auto-preload do catÃ¡logo grande para hospedagem (ex: GitHub Pages) ---
        document.addEventListener('DOMContentLoaded', async function() {
            function detectBasePath() {
                try {
                    const url = new URL(document.baseURI || window.location.href);
                    // retorna caminho com / no final: '/repo/' ou '/'
                    return url.pathname.replace(/\/index\.html$|\/$/, '/') || '/';
                } catch (e) {
                    return '/';
                }
            }

            const base = detectBasePath();
            const externalInput = document.getElementById('externalMedUrl');
            if (externalInput && !externalInput.value.trim()) {
                // prefira caminho absoluto ajustado ao base
                const candidate = base.replace(/\/$/, '') + '/medicacoes/medicamentos_full.json';
                externalInput.value = candidate;
            }

            // tentar carregar automaticamente alguns candidatos para popular window.medicineCatalog
            const candidates = [];
            if (externalInput && externalInput.value.trim()) candidates.push(externalInput.value.trim());
            candidates.push('medicacoes/medicamentos_full.json');
            candidates.push(base.replace(/\/$/, '') + '/medicacoes/medicamentos_full.json');

            window._medicineLoadAttempts = [];
            for (const c of candidates) {
                try {
                    window._medicineLoadAttempts.push(c);
                    const resp = await fetch(c);
                    if (resp.ok) {
                        const data = await resp.json();
                        applyMedicationsToMemory(data);
                        console.debug('CatÃ¡logo grande carregado automaticamente de', c);
                        break;
                    } else {
                        console.debug('Tentativa de carregar catÃ¡logo retornou', resp.status, c);
                    }
                } catch (err) {
                    console.debug('Falha ao tentar carregar catÃ¡logo em', c, err.message || err);
                }
            }
        });
    </script>
    
    <!-- Modal de Lista de Medicamentos -->
    <div class="modal" id="medicineModal" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Lista de Medicamentos</h3>
                <button class="close-modal" onclick="closeMedicineModal()">â</button>
            </div>
            <div style="margin-bottom:12px; display:flex; gap:8px; align-items:center;">
                <input type="text" id="modalMedicineSearch" placeholder="Pesquisar medicamento..." onkeyup="filterMedicineModal(this.value)" style="flex:1; padding:10px; border:1px solid var(--border); border-radius:8px;">
                <button class="btn btn-primary" style="padding:8px 12px;" onclick="forceReloadMedicaments()">Recarregar</button>
            </div>
            <!-- removed debug info per user request -->
            <div style="max-height:400px; overflow-y:auto; border:1px solid var(--border); padding:10px; border-radius:8px;">
                <div id="modalMedicineList">
                    <!-- Lista gerada dinamicamente -->
                </div>
            </div>
            <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:12px;">
                <button class="btn btn-success" onclick="addSelectedMedicines()">Adicionar Selecionados</button>
                <button class="btn" onclick="closeMedicineModal()">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Lista de Exames -->
    <div class="modal" id="examModal" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Lista de Exames - SeleÃ§Ã£o por Categoria</h3>
                <button class="close-modal" onclick="closeExamModal()">â</button>
            </div>
            <div style="margin-bottom:12px;">
                <label>Selecione a categoria:</label>
                <div style="display:flex; gap:10px; margin-top:8px;">
                    <button class="btn btn-outline" onclick="loadExamCategory('crianca')">ð¶ CrianÃ§a</button>
                    <button class="btn btn-outline" onclick="loadExamCategory('adolescente')">ð§ Adolescente</button>
                    <button class="btn btn-outline" onclick="loadExamCategory('mulher')">ð© Mulher</button>
                    <button class="btn btn-outline" onclick="loadExamCategory('homem')">ð¨ Homem</button>
                </div>
            </div>
            <div style="margin-bottom:12px;">
                <input type="text" id="modalExamSearch" placeholder="Pesquisar exame..." onkeyup="filterExamModal(this.value)" style="width:100%; padding:10px; border:1px solid var(--border); border-radius:8px;">
            </div>
            <div style="max-height:400px; overflow-y:auto; border:1px solid var(--border); padding:10px; border-radius:8px;">
                <div id="modalExamList">
                    <p style="color:#6b7280; text-align:center;">Selecione uma categoria para carregar os exames.</p>
                </div>
            </div>
            <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:12px;">
                <button class="btn btn-success" onclick="addSelectedExams()">Adicionar Selecionados</button>
                <button class="btn" onclick="closeExamModal()">Fechar</button>
            </div>
        </div>
    </div>
</body>
</html>